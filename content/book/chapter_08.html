<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<title>Testing Deployment Using a Staging Site</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="buy_the_book" style="position: absolute; top: 0; right: 0; z-index:100">
  <a href="/pages/book.html">
    <img src="images/buy_the_book.svg" alt="buy the book ribbon">
  </a>
</div>
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="/book/praise.harry.html">Praise for <em>Test-Driven Development with Python</em></a></li>
<li><a href="/book/preface.html">Preface</a>
<ul class="sectlevel2">
<li><a href="/book/preface.html#_why_i_wrote_a_book_about_test_driven_development">Why I Wrote a Book About Test-Driven Development</a></li>
<li><a href="/book/preface.html#_aims_of_this_book">Aims of This Book</a></li>
<li><a href="/book/preface.html#_outline">Outline</a></li>
<li><a href="/book/preface.html#_conventions_used_in_this_book">Conventions Used in This Book</a></li>
<li><a href="/book/preface.html#_using_code_examples">Using Code Examples</a></li>
<li><a href="/book/preface.html#_safari_books_online">Safari&#174; Books Online</a></li>
<li><a href="/book/preface.html#_contacting_o_reilly">Contacting O&#8217;Reilly</a></li>
</ul>
</li>
<li><a href="/book/pre-requisite-installations.html">Prerequisites and Assumptions</a>
<ul class="sectlevel2">
<li><a href="/book/pre-requisite-installations.html#_python_3_and_programming">Python 3 and Programming</a></li>
<li><a href="/book/pre-requisite-installations.html#_how_html_works">How HTML Works</a></li>
<li><a href="/book/pre-requisite-installations.html#_django">Django</a></li>
<li><a href="/book/pre-requisite-installations.html#_javascript">JavaScript</a></li>
<li><a href="/book/pre-requisite-installations.html#_required_software_installations">Required Software Installations</a></li>
</ul>
</li>
<li><a href="/book/video_plug.html">Companion Video</a></li>
<li><a href="/book/acknowledgments.html">Acknowledgments</a></li>
<li><a href="/book/part1.harry.html">The Basics of TDD and Django</a>
<ul class="sectlevel1">
<li><a href="/book/chapter_01.html">1. Getting Django Set Up Using a Functional Test</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_01.html#_obey_the_testing_goat_do_nothing_until_you_have_a_test">1.1. Obey the Testing Goat! Do Nothing Until You Have a Test</a></li>
<li><a href="/book/chapter_01.html#_getting_django_up_and_running">1.2. Getting Django Up and Running</a></li>
<li><a href="/book/chapter_01.html#_starting_a_git_repository">1.3. Starting a Git Repository</a></li>
</ul>
</li>
<li><a href="/book/chapter_02.html">2. Extending Our Functional Test Using the unittest Module</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_02.html#_using_a_functional_test_to_scope_out_a_minimum_viable_app">2.1. Using a Functional Test to Scope Out a Minimum Viable App</a></li>
<li><a href="/book/chapter_02.html#_the_python_standard_library_s_unittest_module">2.2. The Python Standard Library&#8217;s unittest Module</a></li>
<li><a href="/book/chapter_02.html#_implicit_waits">2.3. Implicit waits</a></li>
<li><a href="/book/chapter_02.html#_commit">2.4. Commit</a></li>
</ul>
</li>
<li><a href="/book/chapter_03.html">3. Testing a Simple Home Page with Unit Tests</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_03.html#_our_first_django_app_and_our_first_unit_test">3.1. Our First Django App, and Our First Unit Test</a></li>
<li><a href="/book/chapter_03.html#_unit_tests_and_how_they_differ_from_functional_tests">3.2. Unit Tests, and How They Differ from Functional Tests</a></li>
<li><a href="/book/chapter_03.html#_unit_testing_in_django">3.3. Unit Testing in Django</a></li>
<li><a href="/book/chapter_03.html#_django_s_mvc_urls_and_view_functions">3.4. Django&#8217;s MVC, URLs, and View Functions</a></li>
<li><a href="/book/chapter_03.html#_at_last_we_actually_write_some_application_code">3.5. At Last! We Actually Write Some Application Code!</a></li>
<li><a href="/book/chapter_03.html#_urls_py">3.6. urls.py</a></li>
<li><a href="/book/chapter_03.html#_unit_testing_a_view">3.7. Unit Testing a View</a></li>
</ul>
</li>
<li><a href="/book/chapter_04.html">4. What Are We Doing with All These Tests?</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_04.html#_programming_is_like_pulling_a_bucket_of_water_up_from_a_well">4.1. Programming Is like Pulling a Bucket of Water up from a Well</a></li>
<li><a href="/book/chapter_04.html#_using_selenium_to_test_user_interactions">4.2. Using Selenium to Test User Interactions</a></li>
<li><a href="/book/chapter_04.html#_the_don_t_test_constants_rule_and_templates_to_the_rescue">4.3. The &#8220;Don&#8217;t Test Constants&#8221; Rule, and Templates to the Rescue</a></li>
<li><a href="/book/chapter_04.html#_on_refactoring">4.4. On Refactoring</a></li>
<li><a href="/book/chapter_04.html#_a_little_more_of_our_front_page">4.5. A Little More of Our Front Page</a></li>
<li><a href="/book/chapter_04.html#_recap_the_tdd_process">4.6. Recap: The TDD Process</a></li>
</ul>
</li>
<li><a href="/book/chapter_05.html">5. Saving User Input</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_05.html#_wiring_up_our_form_to_send_a_post_request">5.1. Wiring Up Our Form to Send a POST Request</a></li>
<li><a href="/book/chapter_05.html#_processing_a_post_request_on_the_server">5.2. Processing a POST Request on the Server</a></li>
<li><a href="/book/chapter_05.html#_passing_python_variables_to_be_rendered_in_the_template">5.3. Passing Python Variables to Be Rendered in the Template</a></li>
<li><a href="/book/chapter_05.html#_three_strikes_and_refactor">5.4. Three Strikes and Refactor</a></li>
<li><a href="/book/chapter_05.html#_the_django_orm_and_our_first_model">5.5. The Django ORM and Our First Model</a></li>
<li><a href="/book/chapter_05.html#_saving_the_post_to_the_database">5.6. Saving the POST to the Database</a></li>
<li><a href="/book/chapter_05.html#_redirect_after_a_post">5.7. Redirect After a POST</a></li>
<li><a href="/book/chapter_05.html#_rendering_items_in_the_template">5.8. Rendering Items in the Template</a></li>
<li><a href="/book/chapter_05.html#_creating_our_production_database_with_migrate">5.9. Creating Our Production Database with migrate</a></li>
</ul>
</li>
<li><a href="/book/chapter_06.html">6. Getting to the Minimum Viable Site</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_06.html#_ensuring_test_isolation_in_functional_tests">6.1. Ensuring Test Isolation in Functional Tests</a></li>
<li><a href="/book/chapter_06.html#_small_design_when_necessary">6.2. Small Design When Necessary</a></li>
<li><a href="/book/chapter_06.html#_implementing_the_new_design_using_tdd">6.3. Implementing the New Design Using TDD</a></li>
<li><a href="/book/chapter_06.html#_iterating_towards_the_new_design">6.4. Iterating Towards the New Design</a></li>
<li><a href="/book/chapter_06.html#_testing_views_templates_and_urls_together_with_the_django_test_client">6.5. Testing Views, Templates, and URLs Together with the Django Test Client</a></li>
<li><a href="/book/chapter_06.html#_another_url_and_view_for_adding_list_items">6.6. Another URL and View for Adding List Items</a></li>
<li><a href="/book/chapter_06.html#_adjusting_our_models">6.7. Adjusting Our Models</a></li>
<li><a href="/book/chapter_06.html#_each_list_should_have_its_own_url">6.8. Each List Should Have Its Own URL</a></li>
<li><a href="/book/chapter_06.html#_one_more_view_to_handle_adding_items_to_an_existing_list">6.9. One More View to Handle Adding Items to an Existing List</a></li>
<li><a href="/book/chapter_06.html#_a_final_refactor_using_url_includes">6.10. A Final Refactor Using URL includes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/book/part2.harry.html">Web Development Sine Qua Nons</a>
<ul class="sectlevel1">
<li><a href="/book/chapter_07.html">7. Prettification: Layout and Styling, and What to Test About It</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_07.html#_what_to_functionally_test_about_layout_and_style">7.1. What to Functionally Test About Layout and Style</a></li>
<li><a href="/book/chapter_07.html#_prettification_using_a_css_framework">7.2. Prettification: Using a CSS Framework</a></li>
<li><a href="/book/chapter_07.html#_django_template_inheritance">7.3. Django Template Inheritance</a></li>
<li><a href="/book/chapter_07.html#_integrating_bootstrap">7.4. Integrating Bootstrap</a></li>
<li><a href="/book/chapter_07.html#_static_files_in_django">7.5. Static Files in Django</a></li>
<li><a href="/book/chapter_07.html#_using_bootstrap_components_to_improve_the_look_of_the_site">7.6. Using Bootstrap Components to Improve the Look of the Site</a></li>
<li><a href="/book/chapter_07.html#_using_our_own_css">7.7. Using Our Own CSS</a></li>
<li><a href="/book/chapter_07.html#_what_we_glossed_over_collectstatic_and_other_static_directories">7.8. What We Glossed Over: collectstatic and Other Static Directories</a></li>
<li><a href="/book/chapter_13.html#_a_few_things_that_didn_t_make_it">7.9. A Few Things That Didn&#8217;t Make It</a></li>
</ul>
</li>
<li><a href="/book/chapter_08.html">8. Testing Deployment Using a Staging Site</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_08.html#_tdd_and_the_danger_areas_of_deployment">8.1. TDD and the Danger Areas of Deployment</a></li>
<li><a href="/book/chapter_08.html#_as_always_start_with_a_test">8.2. As Always, Start with a Test</a></li>
<li><a href="/book/chapter_08.html#_getting_a_domain_name">8.3. Getting a Domain Name</a></li>
<li><a href="/book/chapter_08.html#_manually_provisioning_a_server_to_host_our_site">8.4. Manually Provisioning a Server to Host Our Site</a></li>
<li><a href="/book/chapter_08.html#_deploying_our_code_manually">8.5. Deploying Our Code Manually</a></li>
<li><a href="/book/chapter_08.html#_getting_to_a_production_ready_deployment">8.6. Getting to a Production-Ready Deployment</a></li>
<li><a href="/book/chapter_08.html#_automating">8.7. Automating</a></li>
</ul>
</li>
<li><a href="/book/chapter_09.html">9. Automating Deployment with Fabric</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_09.html#_breakdown_of_a_fabric_script_for_our_deployment">9.1. Breakdown of a Fabric Script for Our Deployment</a></li>
<li><a href="/book/chapter_09.html#_trying_it_out">9.2. Trying It Out</a></li>
<li><a href="/book/chapter_09.html#_git_tag_the_release">9.3. Git Tag the Release</a></li>
<li><a href="/book/chapter_09.html#_further_reading">9.4. Further Reading</a></li>
</ul>
</li>
<li><a href="/book/chapter_10.html">10. Input Validation and Test Organisation</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_10.html#_validation_ft_preventing_blank_items">10.1. Validation FT: Preventing Blank Items</a></li>
<li><a href="/book/chapter_10.html#_using_model_layer_validation">10.2. Using Model-Layer Validation</a></li>
<li><a href="/book/chapter_10.html#_surfacing_model_validation_errors_in_the_view">10.3. Surfacing Model Validation Errors in the View</a></li>
<li><a href="/book/chapter_10.html#_django_pattern_processing_post_requests_in_the_same_view_as_renders_the_form">10.4. Django Pattern: Processing POST Requests in the Same View as Renders the Form</a></li>
<li><a href="/book/chapter_10.html#_refactor_removing_hardcoded_urls">10.5. Refactor: Removing Hardcoded URLs</a></li>
</ul>
</li>
<li><a href="/book/chapter_11.html">11. A Simple Form</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_11.html#_moving_validation_logic_into_a_form">11.1. Moving Validation Logic into a Form</a></li>
<li><a href="/book/chapter_11.html#_using_the_form_in_our_views">11.2. Using the Form in Our Views</a></li>
<li><a href="/book/chapter_11.html#_using_the_form_in_a_view_that_takes_post_requests">11.3. Using the Form in a View That Takes POST Requests</a></li>
<li><a href="/book/chapter_11.html#_using_the_form_in_the_other_view">11.4. Using the Form in the Other View</a></li>
<li><a href="/book/chapter_11.html#_using_the_form_s_own_save_method">11.5. Using the Form&#8217;s Own Save Method</a></li>
</ul>
</li>
<li><a href="/book/chapter_12.html">12. More Advanced Forms</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_12.html#_another_ft_for_duplicate_items">12.1. Another FT for Duplicate Items</a></li>
<li><a href="/book/chapter_12.html#_experimenting_with_duplicate_item_validation_at_the_views_layer">12.2. Experimenting with Duplicate Item Validation at the Views Layer</a></li>
<li><a href="/book/chapter_12.html#_a_more_complex_form_to_handle_uniqueness_validation">12.3. A More Complex Form to Handle Uniqueness Validation</a></li>
<li><a href="/book/chapter_12.html#_using_the_existing_list_item_form_in_the_list_view">12.4. Using the Existing List Item Form in the List View</a></li>
</ul>
</li>
<li><a href="/book/chapter_13.html">13. Dipping Our Toes, Very Tentatively, into JavaScript</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_13.html#_starting_with_an_ft">13.1. Starting with an FT</a></li>
<li><a href="/book/chapter_13.html#_setting_up_a_basic_javascript_test_runner">13.2. Setting Up a Basic JavaScript Test Runner</a></li>
<li><a href="/book/chapter_13.html#_using_jquery_and_the_fixtures_div">13.3. Using jQuery and the Fixtures Div</a></li>
<li><a href="/book/chapter_13.html#_building_a_javascript_unit_test_for_our_desired_functionality">13.4. Building a JavaScript Unit Test for Our Desired Functionality</a></li>
<li><a href="/book/chapter_13.html#_fixtures_execution_order_and_global_state_key_challenges_of_js_testing">13.5. Fixtures, execution order and global state: key challenges of js testing</a></li>
<li><a href="/book/chapter_13.html#_columbo_says_onload_boilerplate_and_namespacing">13.6. Columbo Says: Onload Boilerplate and Namespacing</a></li>
<li><a href="/book/chapter_13.html#_javascript_testing_in_the_tdd_cycle">13.7. Javascript Testing in the TDD Cycle</a></li>
<li><a href="#_a_few_things_that_didn_t_make_it_2">13.8. A Few Things That Didn&#8217;t Make It</a></li>
</ul>
</li>
<li><a href="/book/chapter_14.html">14. Deploying Our New Code</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_14.html#_staging_deploy">14.1. Staging Deploy</a></li>
<li><a href="/book/chapter_14.html#_live_deploy">14.2. Live Deploy</a></li>
<li><a href="/book/chapter_14.html#_what_to_do_if_you_see_a_database_error">14.3. What to Do If You See a Database Error</a></li>
<li><a href="/book/chapter_14.html#_wrap_up_git_tag_the_new_release">14.4. Wrap-Up: git tag the New Release</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="/book/part3.harry.html">More Advanced Topics</a>
<ul class="sectlevel1">
<li><a href="/book/chapter_15.html">15. User Authentication, Spiking and De-Spiking</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_15.html#_passwordless_auth">15.1. Passwordless Auth</a></li>
<li><a href="/book/chapter_15.html#_exploratory_coding_aka_spiking">15.2. Exploratory Coding, aka "Spiking"</a></li>
<li><a href="/book/chapter_15.html#_de_spiking">15.3. De-spiking</a></li>
<li><a href="/book/chapter_15.html#_a_minimal_custom_user_model">15.4. A Minimal Custom User Model</a></li>
<li><a href="/book/chapter_15.html#_a_token_model_to_link_emails_with_a_unique_id">15.5. A Token model to link emails with a unique id</a></li>
</ul>
</li>
<li><a href="/book/chapter_16.html">16. Testing external dependencies using mocks</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_16.html#_before_we_start_getting_the_basic_plumbing_in">16.1. Before we start: getting the basic plumbing in</a></li>
<li><a href="/book/chapter_16.html#_mocking_manually_aka_monkey_patching">16.2. Mocking manually, aka monkey-patching</a></li>
<li><a href="/book/chapter_16.html#_the_python_mock_library">16.3. The Python Mock Library</a></li>
<li><a href="/book/chapter_16.html#_de_spiking_our_custom_authentication_backend">16.4. De-spiking Our Custom Authentication Backend</a></li>
<li><a href="/book/chapter_16.html#_using_our_auth_backend_in_the_login_view">16.5. Using our auth backend in the login view</a></li>
<li><a href="/book/chapter_16.html#_the_moment_of_truth_will_the_ft_pass">16.6. The Moment of Truth:  Will the FT Pass?</a></li>
<li><a href="/book/chapter_16.html#_finishing_off_our_ft_testing_logout">16.7. Finishing Off Our FT, Testing Logout</a></li>
<li><a href="/book/chapter_16.html#_old_content_we_might_want_to_re_use">16.8. Old content we might want to re-use</a></li>
</ul>
</li>
<li><a href="/book/chapter_17.html">17. Test Fixtures, and Server-Side Debugging</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_17.html#_skipping_the_login_process_by_pre_creating_a_session">17.1. Skipping the Login Process by Pre-creating a Session</a></li>
<li><a href="/book/chapter_17.html#_the_proof_is_in_the_pudding_using_staging_to_catch_final_bugs">17.2. The Proof Is in the Pudding: Using Staging to Catch Final Bugs</a></li>
<li><a href="/book/chapter_17.html#_setting_secret_environment_variables_on_the_server">17.3. Setting secret environment variables on the server</a></li>
<li><a href="/book/chapter_17.html#_adapting_our_ft_to_be_able_to_test_real_emails_via_pop3">17.4. Adapting our FT to be able to test real emails via POP3</a></li>
<li><a href="/book/chapter_17.html#_managing_the_test_database_on_staging">17.5. Managing the Test Database on Staging</a></li>
<li><a href="/book/chapter_17.html#_baking_in_our_logging_code">17.6. Baking In Our Logging Code</a></li>
<li><a href="/book/chapter_17.html#_wrap_up">17.7. Wrap-Up</a></li>
<li><a href="/book/chapter_17.html#_stuff_from_the_old_edition_that_we_might_want_to_save">17.8. Stuff from the old edition that we might want to save</a></li>
</ul>
</li>
<li><a href="/book/chapter_18.html">18. Finishing "My Lists": Outside-In TDD</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_18.html#_the_alternative_inside_out">18.1. The Alternative: "Inside Out"</a></li>
<li><a href="/book/chapter_18.html#_why_prefer_outside_in">18.2. Why Prefer "Outside-In"?</a></li>
<li><a href="/book/chapter_18.html#_the_ft_for_my_lists">18.3. The FT for "My Lists"</a></li>
<li><a href="/book/chapter_18.html#_the_outside_layer_presentation_and_templates">18.4. The Outside Layer: Presentation and Templates</a></li>
<li><a href="/book/chapter_18.html#_moving_down_one_layer_to_view_functions_the_controller">18.5. Moving Down One Layer to View Functions (the Controller)</a></li>
<li><a href="/book/chapter_18.html#_another_pass_outside_in">18.6. Another Pass, Outside-In</a></li>
<li><a href="/book/chapter_18.html#_the_next_requirement_from_the_views_layer_new_lists_should_record_owner">18.7. The Next "Requirement" from the Views Layer: New Lists Should Record Owner</a></li>
<li><a href="/book/chapter_18.html#_moving_down_to_the_model_layer">18.8. Moving Down to the Model Layer</a></li>
</ul>
</li>
<li><a href="/book/chapter_19.html">19. Test Isolation, and "Listening to Your Tests"</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_19.html#_revisiting_our_decision_point_the_views_layer_depends_on_unwritten_models_code">19.1. Revisiting Our Decision Point: The Views Layer Depends on Unwritten Models Code</a></li>
<li><a href="/book/chapter_19.html#_a_first_attempt_at_using_mocks_for_isolation">19.2. A First Attempt at Using Mocks for Isolation</a></li>
<li><a href="/book/chapter_19.html#_listen_to_your_tests_ugly_tests_signal_a_need_to_refactor">19.3. Listen to Your Tests: Ugly Tests Signal a Need to Refactor</a></li>
<li><a href="/book/chapter_19.html#_rewriting_our_tests_for_the_view_to_be_fully_isolated">19.4. Rewriting Our Tests for the View to Be Fully Isolated</a></li>
<li><a href="/book/chapter_19.html#_moving_down_to_the_forms_layer">19.5. Moving Down to the Forms Layer</a></li>
<li><a href="/book/chapter_19.html#_finally_moving_down_to_the_models_layer">19.6. Finally, Moving Down to the Models Layer</a></li>
<li><a href="/book/chapter_19.html#_the_moment_of_truth_and_the_risks_of_mocking">19.7. The Moment of Truth (and the Risks of Mocking)</a></li>
<li><a href="/book/chapter_19.html#_thinking_of_interactions_between_layers_as_contracts">19.8. Thinking of Interactions Between Layers as "Contracts"</a></li>
<li><a href="/book/chapter_19.html#_one_more_test">19.9. One More Test</a></li>
<li><a href="/book/chapter_19.html#_tidy_up_what_to_keep_from_our_integrated_test_suite">19.10. Tidy Up: What to Keep from Our Integrated Test Suite</a></li>
<li><a href="/book/chapter_19.html#_conclusions_when_to_write_isolated_versus_integrated_tests">19.11. Conclusions: When to Write Isolated Versus Integrated Tests</a></li>
</ul>
</li>
<li><a href="/book/chapter_20.html">20. Continuous Integration (CI)</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_20.html#_installing_jenkins">20.1. Installing Jenkins</a></li>
<li><a href="/book/chapter_20.html#_setting_up_our_project">20.2. Setting Up Our Project</a></li>
<li><a href="/book/chapter_20.html#_first_build">20.3. First Build!</a></li>
<li><a href="/book/chapter_20.html#_setting_up_a_virtual_display_so_the_fts_can_run_headless">20.4. Setting Up a Virtual Display so the FTs Can Run Headless</a></li>
<li><a href="/book/chapter_20.html#_taking_screenshots">20.5. Taking Screenshots</a></li>
<li><a href="/book/chapter_20.html#_a_common_selenium_problem_race_conditions">20.6. A Common Selenium Problem: Race Conditions</a></li>
<li><a href="/book/chapter_20.html#_running_our_qunit_javascript_tests_in_jenkins_with_phantomjs">20.7. Running Our QUnit JavaScript Tests in Jenkins with PhantomJS</a></li>
<li><a href="/book/chapter_20.html#_more_things_to_do_with_a_ci_server">20.8. More Things to Do with a CI Server</a></li>
<li><a href="/book/chapter_20.html#_notes_for_latest_jenkins">20.9. Notes for latest jenkins</a></li>
</ul>
</li>
<li><a href="/book/chapter_21.html">21. The Token Social Bit, the Page Pattern, and an Exercise for the Reader</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_21.html#_an_ft_with_multiple_users_and_addcleanup">21.1. An FT with Multiple Users, and addCleanup</a></li>
<li><a href="/book/chapter_21.html#_implementing_the_selenium_interact_wait_pattern">21.2. Implementing the Selenium Interact/Wait Pattern</a></li>
<li><a href="/book/chapter_21.html#_the_page_pattern">21.3. The Page Pattern</a></li>
<li><a href="/book/chapter_21.html#_extend_the_ft_to_a_second_user_and_the_my_lists_page">21.4. Extend the FT to a Second User, and the "My Lists" Page</a></li>
<li><a href="/book/chapter_21.html#_an_exercise_for_the_reader">21.5. An Exercise for the Reader</a></li>
</ul>
</li>
<li><a href="/book/chapter_22.html">22. Fast Tests, Slow Tests, and Hot Lava</a>
<ul class="sectlevel2">
<li><a href="/book/chapter_22.html#_thesis_unit_tests_are_superfast_and_good_besides_that">22.1. Thesis: Unit Tests Are Superfast and Good Besides That</a></li>
<li><a href="/book/chapter_22.html#_the_problems_with_pure_unit_tests">22.2. The Problems with "Pure" Unit Tests</a></li>
<li><a href="/book/chapter_22.html#_synthesis_what_do_we_want_from_our_tests_anyway">22.3. Synthesis: What Do We Want from Our Tests, Anyway?</a></li>
<li><a href="/book/chapter_22.html#_architectural_solutions">22.4. Architectural Solutions</a></li>
<li><a href="/book/chapter_22.html#_conclusion">22.5. Conclusion</a></li>
</ul>
</li>
<li><a href="/book/epilogue.html">23. Obey the Testing Goat!</a>
<ul class="sectlevel2">
<li><a href="/book/epilogue.html#_testing_is_hard">23.1. Testing Is Hard</a></li>
<li><a href="/book/epilogue.html#_remember_to_tip_the_bar_staff">23.2. Remember to Tip the Bar Staff</a></li>
<li><a href="/book/epilogue.html#_don_t_be_a_stranger">23.3. Don&#8217;t Be a Stranger!</a></li>
</ul>
</li>
<li><a href="/book/appendix_I_PythonAnywhere.html">Appendix A: PythonAnywhere</a>
<ul class="sectlevel2">
<li><a href="/book/appendix_I_PythonAnywhere.html#_starting_a_virtualenv">A.1. Starting a virtualenv</a></li>
<li><a href="/book/appendix_I_PythonAnywhere.html#_running_firefox_selenium_sessions_with_xvfb">A.2. Running Firefox Selenium Sessions with Xvfb</a></li>
<li><a href="/book/appendix_I_PythonAnywhere.html#_setting_up_django_as_a_pythonanywhere_web_app">A.3. Setting Up Django as a PythonAnywhere Web App</a></li>
<li><a href="/book/appendix_I_PythonAnywhere.html#_cleaning_up_tmp">A.4. Cleaning Up /tmp</a></li>
<li><a href="/book/appendix_I_PythonAnywhere.html#_screenshots">A.5. Screenshots</a></li>
<li><a href="/book/appendix_I_PythonAnywhere.html#_the_deployment_chapter">A.6. The Deployment Chapter</a></li>
</ul>
</li>
<li><a href="/book/appendix_II_Django_Class-Based_Views.html">Appendix B: Django Class-Based Views</a>
<ul class="sectlevel2">
<li><a href="/book/appendix_II_Django_Class-Based_Views.html#_class_based_generic_views">B.1. Class-Based Generic Views</a></li>
<li><a href="/book/appendix_II_Django_Class-Based_Views.html#_the_home_page_as_a_formview">B.2. The Home Page as a FormView</a></li>
<li><a href="/book/appendix_II_Django_Class-Based_Views.html#_using_form_valid_to_customise_a_createview">B.3. Using form_valid to Customise a CreateView</a></li>
<li><a href="/book/appendix_II_Django_Class-Based_Views.html#_a_more_complex_view_to_handle_both_viewing_and_adding_to_a_list">B.4. A More Complex View to Handle Both Viewing and Adding to a List</a></li>
<li><a href="/book/appendix_II_Django_Class-Based_Views.html#_compare_old_and_new">B.5. Compare Old and New</a></li>
<li><a href="/book/appendix_II_Django_Class-Based_Views.html#_best_practices_for_unit_testing_cbgvs">B.6. Best Practices for Unit Testing CBGVs?</a></li>
</ul>
</li>
<li><a href="/book/appendix_III_provisioning_with_ansible.html">Appendix C: Provisioning with Ansible</a>
<ul class="sectlevel2">
<li><a href="/book/appendix_III_provisioning_with_ansible.html#_installing_system_packages_and_nginx">C.1. Installing System Packages and Nginx</a></li>
<li><a href="/book/appendix_III_provisioning_with_ansible.html#_configuring_gunicorn_and_using_handlers_to_restart_services">C.2. Configuring Gunicorn, and Using Handlers to Restart Services</a></li>
<li><a href="/book/appendix_III_provisioning_with_ansible.html#_what_to_do_next">C.3. What to Do Next</a></li>
</ul>
</li>
<li><a href="/book/appendix_IV_testing_migrations.html">Appendix D: Testing Database Migrations</a>
<ul class="sectlevel2">
<li><a href="/book/appendix_IV_testing_migrations.html#_an_attempted_deploy_to_staging">D.1. An Attempted Deploy to Staging</a></li>
<li><a href="/book/appendix_IV_testing_migrations.html#_running_a_test_migration_locally">D.2. Running a Test Migration Locally</a></li>
<li><a href="/book/appendix_IV_testing_migrations.html#_inserting_a_data_migration">D.3. Inserting a Data Migration</a></li>
<li><a href="/book/appendix_IV_testing_migrations.html#_testing_the_new_migrations_together">D.4. Testing the New Migrations Together</a></li>
<li><a href="/book/appendix_IV_testing_migrations.html#_conclusions">D.5. Conclusions</a></li>
</ul>
</li>
<li><a href="/book/appendix_V_bdd_tools.html">Appendix E: Behaviour-Driven Development (BDD)</a>
<ul class="sectlevel2">
<li><a href="/book/appendix_V_bdd_tools.html#_what_is_bdd">E.1. What is BDD?</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_basic_housekeeping">E.2. Basic Housekeeping</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_writing_an_ft_as_a_feature_using_gherkin_syntax">E.3. Writing an FT as a "Feature" using Gherkin Syntax</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_coding_the_step_functions">E.4. Coding the Step Functions</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_first_step_definition">E.5. First Step Definition</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_setup_and_teardown_equivalents_in_environment_py">E.6. setUp and tearDown Equivalents in environment.py</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_another_run">E.7. Another Run</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_capturing_parameters_in_steps">E.8. Capturing Parameters in Steps</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_comparing_the_inline_style_ft">E.9. Comparing the Inline-Style FT</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_bdd_encourages_structured_test_code">E.10. BDD Encourages Structured Test Code</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_the_page_pattern_as_an_alternative">E.11. The Page Pattern as an Alternative</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_bdd_might_be_less_expressive_than_inline_comments">E.12. BDD Might Be Less Expressive than Inline Comments</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_will_nonprogrammers_write_tests">E.13. Will Nonprogrammers Write Tests?</a></li>
<li><a href="/book/appendix_V_bdd_tools.html#_some_tentative_conclusions">E.14. Some Tentative Conclusions</a></li>
</ul>
</li>
<li><a href="/book/appendix_VI_rest_api.html">Appendix F: Building a REST API: JSON, Ajax, and mocking with JavaScript</a>
<ul class="sectlevel2">
<li><a href="/book/appendix_VI_rest_api.html#_basic_piping">F.1. Basic piping</a></li>
<li><a href="/book/appendix_VI_rest_api.html#_actually_responding_something">F.2. Actually responding something</a></li>
<li><a href="/book/appendix_VI_rest_api.html#_adding_post">F.3. Adding POST</a></li>
<li><a href="/book/appendix_VI_rest_api.html#_testing_the_client_side_with_sinon_js">F.4. Testing the client-side with sinon.js</a></li>
<li><a href="/book/appendix_VI_rest_api.html#_wiring_it_all_up_in_the_template_to_check_it_all_works_so_far">F.5. Wiring it all up in the template to check it all works so far</a></li>
<li><a href="/book/appendix_VI_rest_api.html#_implementing_ajax_post">F.6. Implementing Ajax POST</a></li>
<li><a href="/book/appendix_VI_rest_api.html#_mocking_in_javascript">F.7. Mocking in JavaScript</a></li>
<li><a href="/book/appendix_VI_rest_api.html#_data_validation_an_exercise_for_the_reader">F.8. Data validation.  An exercise for the reader?</a></li>
</ul>
</li>
<li><a href="/book/appendix_VII_DjangoRestFramework.html">Appendix G: Django-Rest-Framework</a>
<ul class="sectlevel2">
<li><a href="/book/appendix_VII_DjangoRestFramework.html#_serializers_well_modelserializers_really">G.1. Serializers (well, ModelSerializers really)</a></li>
<li><a href="/book/appendix_VII_DjangoRestFramework.html#_viewsets_well_modelviewsets_really_and_routers">G.2. Viewsets (well, ModelViewsets really) and routers</a></li>
<li><a href="#_and_giving_up_and_adding_a_url">G.3. And giving up, and adding a URL</a></li>
<li><a href="/book/appendix_VII_DjangoRestFramework.html#_adapting_the_client_side">G.4. Adapting the client side</a></li>
</ul>
</li>
<li><a href="/book/appendix_IX_cheat_sheet.html">Appendix H: Cheat Sheet</a>
<ul class="sectlevel2">
<li><a href="/book/appendix_IX_cheat_sheet.html#_initial_project_setup">H.1. Initial Project Setup</a></li>
<li><a href="/book/appendix_IX_cheat_sheet.html#_the_basic_tdd_workflow">H.2. The Basic TDD Workflow</a></li>
<li><a href="/book/appendix_IX_cheat_sheet.html#_moving_beyond_dev_only_testing">H.3. Moving Beyond dev-only Testing</a></li>
<li><a href="/book/appendix_IX_cheat_sheet.html#_general_testing_best_practices">H.4. General Testing Best Practices</a></li>
<li><a href="/book/appendix_IX_cheat_sheet.html#_selenium_functional_testing_best_practices">H.5. Selenium/Functional Testing Best Practices</a></li>
<li><a href="/book/appendix_IX_cheat_sheet.html#_outside_in_test_isolation_versus_integrated_tests_and_mocking">H.6. Outside-In, Test Isolation Versus Integrated Tests, and Mocking</a></li>
</ul>
</li>
<li><a href="/book/appendix_X_what_to_do_next.html">Appendix I: What to Do Next</a>
<ul class="sectlevel2">
<li><a href="/book/appendix_X_what_to_do_next.html#_notifications_both_on_the_site_and_by_email">I.1. Notifications&#8212;&#8203;Both on the Site and by Email</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_switch_to_postgres">I.2. Switch to Postgres</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_run_your_tests_against_different_browsers">I.3. Run Your Tests Against Different Browsers</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_404_and_500_tests">I.4. 404 and 500 Tests</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_the_django_admin_site">I.5. The Django Admin Site</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_write_some_security_tests">I.6. Write Some Security Tests</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_test_for_graceful_degradation">I.7. Test for Graceful Degradation</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_caching_and_performance_testing">I.8. Caching and Performance Testing</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_javascript_mvc_frameworks">I.9. JavaScript MVC Frameworks</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_async_and_websockets">I.10. Async and Websockets</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_switch_to_using_py_test">I.11. Switch to Using py.test</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_check_out_coverage_py">I.12. Check out coverage.py</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_client_side_encryption">I.13. Client-Side Encryption</a></li>
<li><a href="/book/appendix_X_what_to_do_next.html#_your_suggestion_here">I.14. Your Suggestion Here</a></li>
</ul>
</li>
<li><a href="/book/bibliography.html">Appendix J: Bibliography</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="deployment-chapter">Testing Deployment Using a Staging Site</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Is all fun and game until you are need of put it in production.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; <a href="https://twitter.com/DEVOPS_BORAT/status/192271992253190144">Devops Borat</a>
</div>
</div>
<div class="paragraph">
<p>
It&#8217;s time to deploy the first version of our site and make it public.  They say
that if you wait until you feel ready to ship, then you&#8217;ve waited too long.</p>
</div>
<div class="paragraph">
<p>Is our site usable?  Is it better than nothing? Can we make lists on it? Yes,
yes, yes.</p>
</div>
<div class="paragraph">
<p>No, you can&#8217;t log in yet.  No, you can&#8217;t mark tasks as completed.  But do we
really need any of that stuff? Not really&#8212;&#8203;and you can never be sure what
your users are <em>actually</em> going to do with your site once they get their
hands on it. We think our users want to use the site for to-do lists, but maybe
they actually want to use it to make "top 10 best fly-fishing spots" lists, for
which you don&#8217;t need any kind of &#8220;mark completed&#8221; function. We won&#8217;t know
until we put it out there.</p>
</div>
<div class="paragraph">
<p>In this chapter we&#8217;re going to go through and actually deploy our site to a
real, live web server.</p>
</div>
<div class="paragraph">
<p>You might be tempted to skip this chapter&#8212;&#8203;there&#8217;s lots of daunting stuff
in it, and maybe you think this isn&#8217;t what you signed up for. But I <em>strongly</em>
urge you to give it a go.  This is one of the chapters I&#8217;m most pleased with,
and it&#8217;s one that people often write to me saying they were really glad they
stuck through it.</p>
</div>
<div class="paragraph">
<p>If you&#8217;ve never done a server deployment before, it will demystify a whole
world for you, and there&#8217;s nothing like the feeling of seeing your site live on
the actual Internet. Give it a buzzword name like "DevOps" if that&#8217;s what it
takes to convince you it&#8217;s worth it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Why not ping me a note once your site is live on the web, and send me
the URL? It always gives me a warm and fuzzy feeling&#8230;&#8203;
<a href="mailto:obeythetestinggoat@gmail.com">obeythetestinggoat@gmail.com</a>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_tdd_and_the_danger_areas_of_deployment">TDD and the Danger Areas of Deployment</h3>
<div class="paragraph">
<p>Deploying a site to a live web server can be a tricky topic.  Oft-heard is the
forlorn cry&#8212;"<em>but it works on my machine!</em>".</p>
</div>
<div class="paragraph">
<p>
Some of the danger areas of deployment include:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Static files (CSS, JavaScript, images, etc.)</dt>
<dd>
<p>Web servers usually need special configuration for serving these.
</p>
</dd>
<dt class="hdlist1">The database</dt>
<dd>
<p>There can be permissions and path issues, and we need to be careful about
preserving data between deploys.
</p>
</dd>
<dt class="hdlist1">Dependencies</dt>
<dd>
<p>We need to make sure that the packages our software relies on are installed
on the server, and have the correct versions.

</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>But there are solutions to all of these.  In order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using a <em>staging site</em>, on the same infrastructure as the production site,
can help us test out our deployments and get things right before we go to the
"real" site.
</p>
</li>
<li>
<p>We can also <em>run our functional tests against the staging site</em>. That will
reassure us that we have the right code and packages on the server, and
since we now have a "smoke test" for our site layout, we&#8217;ll know that the CSS
is loaded correctly.
</p>
</li>
<li>
<p><em>Virtualenvs</em> are a useful tool for managing packages and dependencies
on a machine that might be running more than one Python application.
</p>
</li>
<li>
<p>And finally, <em>automation, automation, automation</em>.  By using an automated
script to deploy new versions, and by using the same script to deploy to
staging and production, we can reassure ourselves that staging is as much
like live as
possible.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</sup>

</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Over the next few pages I&#8217;m going to go through <em>a</em> deployment procedure.  It
isn&#8217;t meant to be the <em>perfect</em> deployment procedure, so please don&#8217;t take
it as being best practice, or a recommendation&#8212;&#8203;it&#8217;s meant to be an
illustration, to show the kinds of issues involved in deployment and where
testing fits in.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Chapter Overview</div>
<div class="paragraph">
<p>
There&#8217;s lots of stuff in this chapter, so here&#8217;s an overview to help you keep
your bearings:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adapt our FTs so they can run against a staging server.</p>
</li>
<li>
<p>Spin up a server, install all the required software on it, and point our
staging and live domains at it.</p>
</li>
<li>
<p>Upload our code to the server using Git.</p>
</li>
<li>
<p>Try and get a quick &amp; dirty version of our site running on the staging domain
using the Django dev server.</p>
</li>
<li>
<p>Learn how to use a virtualenv to manage our project&#8217;s Python dependencies on
the server.</p>
</li>
<li>
<p>As we go, we&#8217;ll keep running our FT, to tell us what&#8217;s working and what&#8217;s
not.</p>
</li>
<li>
<p>Move from our quick &amp; dirty version to a production-ready configuration,
using Gunicorn, Systemd, and domain sockets.</p>
</li>
<li>
<p>Once we have a working config, we&#8217;ll write a script to automate the process
we&#8217;ve just been through manually, so that we can deploy our site
automatically in future.</p>
</li>
<li>
<p>Finally we&#8217;ll use this script to deploy the production version of our site
on its real domain.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_as_always_start_with_a_test">As Always, Start with a Test</h3>
<div class="paragraph">
<p>

Let&#8217;s adapt our functional tests slightly so that it can be run against
a staging site. We&#8217;ll do it by slightly hacking an argument that is normally
used to change the address which the test&#8217;s temporary server gets run on:</p>
</div>
<div class="listingblock sourcecode">
<div class="title">functional_tests/tests.py (ch08l001)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">sys</span>
[...]

<span class="keyword">class</span> <span class="class">NewVisitorTest</span>(StaticLiveServerTestCase):

    <span class="decorator">@classmethod</span>
    <span class="keyword">def</span> <span class="function">setUpClass</span>(cls):  <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="keyword">for</span> arg <span class="keyword">in</span> sys.argv:  <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="keyword">if</span> <span class="string"><span class="delimiter">'</span><span class="content">liveserver</span><span class="delimiter">'</span></span> <span class="keyword">in</span> arg:  <i class="conum" data-value="2"></i><b>(2)</b>
                cls.server_url = <span class="string"><span class="delimiter">'</span><span class="content">http://</span><span class="delimiter">'</span></span> + arg.split(<span class="string"><span class="delimiter">'</span><span class="content">=</span><span class="delimiter">'</span></span>)[<span class="integer">1</span>]  <i class="conum" data-value="3"></i><b>(3)</b>
                <span class="keyword">return</span>  <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="predefined">super</span>().setUpClass()  <i class="conum" data-value="4"></i><b>(4)</b>
        cls.server_url = cls.live_server_url

    <span class="decorator">@classmethod</span>
    <span class="keyword">def</span> <span class="function">tearDownClass</span>(cls):
        <span class="keyword">if</span> cls.server_url == cls.live_server_url:
            <span class="predefined">super</span>().tearDownClass()


    <span class="keyword">def</span> <span class="function">setUp</span>(<span class="predefined-constant">self</span>):
        [...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>OK, when I said slightly hacking, I meant seriously hacking. Do you remember I
said that <code>LiveServerTestCase</code> had certain limitations?  Well, one is that it
always assumes you want to use its own test server.  I still want to be able to
do that sometimes, but I also want to be able to selectively tell it not to
bother, and to use a real server instead.</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>setUpClass</code> is a similar method to <code>setUp</code>, also provided by <code>unittest</code>,
which is used to do test setup for the whole class&#8212;&#8203;that means it only
gets executed once, rather than before every test method. This is where
<code>LiveServerTestCase</code>/<code>StaticLiveServerTestCase</code> usually starts up its test
server.
</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We look for the <code>liveserver</code> command-line argument (which is found in
<code>sys.argv</code>).</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If we find it, we tell our test class to skip the normal <code>setUpClass</code>, and
just store away our staging server URL in a variable called <code>server_url</code>
instead.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>And if the <code>for</code> loop completes <em>without</em> finding a <code>liveserver</code> argument
on the command-line, we do the normal
superclass<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnote_2" title="View footnote.">2</a>]</sup>
setup , and use the normal
<code>live_server_url</code>.  Be careful with the indentation here!</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This means we also need to change the three places we used to use
<code>self.live_server_url</code>:</p>
</div>
<div class="listingblock sourcecode">
<div class="title">functional_tests/tests.py (ch08l002)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">    <span class="keyword">def</span> <span class="function">test_can_start_a_list_and_retrieve_it_later</span>(<span class="predefined-constant">self</span>):
        <span class="comment"># Edith has heard about a cool new online to-do app. She goes</span>
        <span class="comment"># to check out its homepage</span>
        <span class="predefined-constant">self</span>.browser.get(<span class="predefined-constant">self</span>.server_url)
        [...]
        <span class="comment"># Francis visits the home page.  There is no sign of Edith's</span>
        <span class="comment"># list</span>
        <span class="predefined-constant">self</span>.browser.get(<span class="predefined-constant">self</span>.server_url)
        [...]

    <span class="keyword">def</span> <span class="function">test_layout_and_styling</span>(<span class="predefined-constant">self</span>):
        <span class="comment"># Edith goes to the home page</span>
        <span class="predefined-constant">self</span>.browser.get(<span class="predefined-constant">self</span>.server_url)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We test that our little hack hasn&#8217;t broken anything by running the functional
tests "normally":</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>python3 manage.py test functional_tests</strong>
[...]
Ran 2 tests in 8.544s

OK</pre>
</div>
</div>
<div class="paragraph">
<p>And now we can try them against our staging server URL.  I&#8217;m hosting my staging
server at <em>superlists-staging.ottg.eu</em>:</p>
</div>
<div class="listingblock skipme">
<div class="content">
<pre>$ <strong>python3 manage.py test functional_tests --liveserver=superlists-staging.ottg.eu</strong>
Creating test database for alias 'default'...
FE
======================================================================
FAIL: test_can_start_a_list_and_retrieve_it_later
(functional_tests.tests.NewVisitorTest)
 ---------------------------------------------------------------------
Traceback (most recent call last):
  File "/workspace/superlists/functional_tests/tests.py", line 42, in
test_can_start_a_list_and_retrieve_it_later
    self.assertIn('To-Do', self.browser.title)
AssertionError: 'To-Do' not found in 'Domain name registration | Domain names
| Web Hosting | 123-reg'

======================================================================
FAIL: test_layout_and_styling (functional_tests.tests.NewVisitorTest)
 ---------------------------------------------------------------------
Traceback (most recent call last):
  File
"/workspace/superlists/functional_tests/tests.py", line 114, in
test_layout_and_styling
    inputbox = self.browser.find_element_by_id('id_new_item')
[...]
selenium.common.exceptions.NoSuchElementException: Message: Unable to locate
element: {"method":"id","selector":"id_new_item"}
[...]
 ---------------------------------------------------------------------
Ran 2 tests in 16.480s

FAILED (failures=2)
Destroying test database for alias 'default'...</pre>
</div>
</div>
<div class="paragraph">
<p>You can see that both tests are failing, as expected, since I haven&#8217;t
actually set up my staging site yet. In fact, you can see from the
first traceback that the test is actually ending up on the home page of
my domain registrar.</p>
</div>
<div class="paragraph">
<p>The FT seems to be testing the right things though, so let&#8217;s commit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff</strong> # should show changes to functional_tests.py
$ <strong>git commit -am "Hack FT runner to be able to test staging"</strong></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_a_domain_name">Getting a Domain Name</h3>
<div class="paragraph">
<p>


We&#8217;re going to need a couple of domain names at this point in the book&#8212;&#8203;they
can both be subdomains of a single domain.  I&#8217;m going to use
<em>superlists.ottg.eu</em> and <em>superlists-staging.ottg.eu</em>.
If you don&#8217;t already own a domain, this is the time to register one! Again,
this is something I really want you to <em>actually</em> do.  If you&#8217;ve never
registered a domain before, just pick any old registrar and buy a cheap one&#8212;&#8203;it
should only cost you $5 or so, and you can even find free ones.
I promise seeing your site on a "real" web site will be a thrill.</p>
</div>
</div>
<div class="sect2">
<h3 id="_manually_provisioning_a_server_to_host_our_site">Manually Provisioning a Server to Host Our Site</h3>
<div class="paragraph">
<p>



We can separate out "deployment" into two tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Provisioning</em> a new server to be able to host the code</p>
</li>
<li>
<p><em>Deploying</em> a new version of the code to an existing server</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some people like to use a brand new server for every deployment&#8212;&#8203;it&#8217;s what we
do at PythonAnywhere.  That&#8217;s only necessary for larger, more complex sites
though, or major changes to an existing site. For a simple site like ours, it
makes sense to separate the two tasks.  And, although we eventually want both
to be completely automated, we can probably live with a manual provisioning
system for now.</p>
</div>
<div class="paragraph">
<p>As you go through this chapter, you should be aware that provisioning is
something that varies a lot, and that as a result there are few universal
best practices for deployment.  So, rather than trying to remember the
specifics of what I&#8217;m doing here, you should be trying to understand the
rationale, so that you can apply the same kind of thinking in the
specific future circumstances you encounter.</p>
</div>
<div class="sect3">
<h4 id="_choosing_where_to_host_our_site">Choosing Where to Host Our Site</h4>
<div class="paragraph">
<p>
There are loads of different solutions out there these days, but they broadly
fall into two camps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Running your own (possibly virtual) server</p>
</li>
<li>
<p>Using a Platform-As-A-Service (PaaS) offering like Heroku, DotCloud,
OpenShift, or PythonAnywhere</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>


Particularly for small sites, a PaaS offers a lot of advantages, and I would
definitely recommend looking into them.  We&#8217;re not going to use a PaaS in this
book however, for several reasons.  Firstly, I have a conflict of interest, in
that I think PythonAnywhere is the best, but then again I would say that
because I work there.  Secondly, all the PaaS offerings are quite different,
and the procedures to deploy to each vary a lot&#8212;&#8203;learning about one doesn&#8217;t
necessarily tell you about the others. Any one of them might change their
process radically, or simply go out of business by the time you get to read
this book.</p>
</div>
<div class="paragraph">
<p>Instead, we&#8217;ll learn just a tiny bit of good old-fashioned server admin,
including SSH and web server config.  They&#8217;re unlikely to ever go away, and
knowing a bit about them will get you some respect from all the grizzled
dinosaurs out there.</p>
</div>
<div class="paragraph">
<p>What I have done is to try and set up a server in such a way that it&#8217;s a lot
like the environment you get from a PaaS, so you should be able to apply the
lessons we learn in the deployment section, no matter what provisioning
solution you choose.</p>
</div>
</div>
<div class="sect3">
<h4 id="_spinning_up_a_server">Spinning Up a Server</h4>
<div class="paragraph">
<p>

I&#8217;m not going to dictate how you do this&#8212;&#8203;whether you choose Amazon AWS,
Rackspace, Digital Ocean, your own server in your own data centre or a
Raspberry Pi in a cupboard behind the stairs, any solution should be fine, as
long as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your server is running Ubuntu 14.04 (aka "Trusty/LTS")</p>
</li>
<li>
<p>You have root access to it.</p>
</li>
<li>
<p>It&#8217;s on the public Internet.</p>
</li>
<li>
<p>You can SSH into it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I&#8217;m recommending Ubuntu as a distro because it has Python 3.4 and it has some
specific ways of configuring Nginx, which I&#8217;m going to make use of next.  If
you know what you&#8217;re doing, you can probably get away with using something
else, but you&#8217;re on your own.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some people get to this chapter, and are tempted to skip the domain bit,
and the "getting a real server" bit, and just use a VM on their own PC.  Don&#8217;t
do this. It&#8217;s <em>not</em> the same, and you&#8217;ll have more difficulty following the
instructions, which are complicated enough as it is.  If you&#8217;re worried about
cost, dig around and you&#8217;ll find free options for both. Email me if you need
further pointers, I&#8217;m always happy to help.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_user_accounts_ssh_and_privileges">User Accounts, SSH, and Privileges</h4>
<div class="paragraph">
<p>
In these instructions, I&#8217;m assuming that you have a nonroot user account set
up that has "sudo" privileges, so whenever we need to do something that
requires root access, we use sudo, and I&#8217;m explicit about that in the various
instructions below. If you need to create a nonroot user, here&#8217;s how:</p>
</div>
<div class="listingblock skipme">
<div class="content">
<pre># these commands must be run as root
root@server:$ <strong>useradd -m -s /bin/bash elspeth</strong> # add user named elspeth
# -m creates a home folder, -s sets elspeth to use bash by default
root@server:$ <strong>usermod -a -G sudo elspeth</strong> # add elspeth to the sudoers group
root@server:$ <strong>passwd elspeth</strong> # set password for elspeth
root@server:$ <strong>su - elspeth</strong> # switch-user to being elspeth!
elspeth@server:$</pre>
</div>
</div>
<div class="paragraph">
<p>Name your own user whatever you like! I also recommend learning up how to use

private key authentication rather than passwords for SSH.  It&#8217;s a matter of
taking the public key from your own PC, and appending it to
<em>~/.ssh/authorized_keys</em> in the user account on the server. You probably went
through a similar procedure if you signed up for Bitbucket or Github.</p>
</div>
<div class="paragraph">
<p>There are some good instructions
<a href="https://library.linode.com/security/ssh-keys">here</a> (note that <code>ssh-keygen</code> <em>is</em>
available as part of Git-Bash on Windows).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Look out for that <code>elspeth@server</code> in the command-line listings in this
chapter. It indicates commands that must be run on the server, as opposed to
commands you run on your own PC.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_installing_nginx">Installing Nginx</h4>
<div class="paragraph">
<p>
We&#8217;ll need a web server, and all the cool kids are using Nginx these days,
so we will too.  Having fought with Apache for many years, I can tell
you it&#8217;s a blessed relief in terms of the readability of its config files,
if nothing else!</p>
</div>
<div class="paragraph">
<p>Installing Nginx on my server was a matter of doing an <code>apt-get</code>, and I could
then see the default Nginx "Hello World" screen:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>sudo apt-get install nginx</strong>
elspeth@server:$ <strong>sudo systemctl start nginx</strong></pre>
</div>
</div>
<div class="paragraph">
<p>(You may need to do an <code>apt-get update</code> and/or an <code>apt-get upgrade</code> first.)</p>
</div>
<div class="paragraph">
<p>You should be able to go to the IP address of your server, and see the
"Welcome to nginx" page at this point, as in <a href="#nginx-it-works">Nginx&#8212;&#8203;it works!</a>.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t see it, it may be because your firewall does not open port 80 to
the world. On AWS for example, you may need to configure the "security group"
for your server to open port 80.</p>
</div>
<div class="paragraph">
<p>While we&#8217;ve got root access, let&#8217;s make sure the server has the key
pieces of software we need at the system level: Python, Git, pip, and virtualenv.</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>sudo apt-get install git python3 python3-pip</strong>
elspeth@server:$ <strong>sudo pip3 install virtualenv</strong></pre>
</div>
</div>
<div id="nginx-it-works" class="imageblock">
<div class="content">
<img src="images/twdp_0801.png" alt="The default 'Welcome to nginx!' page">
</div>
<div class="title">Figure 1. Nginx&#8212;&#8203;it works!</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_domains_for_staging_and_live">Configuring Domains for Staging and Live</h4>
<div class="paragraph">
<p>We don&#8217;t want to be messing about with IP addresses all the time, so we should
point our staging and live domains to the server. At my registrar, the control
screens looked a bit like <a href="#registrar-control-screens">Domain setup</a>.</p>
</div>
<div id="registrar-control-screens" class="imageblock">
<div class="content">
<img src="images/twdp_0802.png" alt="Registrar control screens for two domains">
</div>
<div class="title">Figure 2. Domain setup</div>
</div>
<div class="paragraph">
<p>In the DNS system, pointing a domain at a specific IP address is called an
"A-Record".  All registrars are slightly different, but a bit of clicking
around should get you to the right screen in yours.</p>
</div>
</div>
<div class="sect3">
<h4 id="_using_the_ft_to_confirm_the_domain_works_and_nginx_is_running">Using the FT to Confirm the Domain Works and Nginx Is Running</h4>
<div class="paragraph">
<p>

To confirm  this works, we can rerun our functional tests and see that their
failure messages have changed slightly&#8212;&#8203;one of them in particular should
now mention Nginx:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>python3 manage.py test functional_tests --liveserver=superlists-staging.ottg.eu</strong>
[...]
selenium.common.exceptions.NoSuchElementException: Message: Unable to locate
element: {"method":"id","selector":"id_new_item"}
[...]
AssertionError: 'To-Do' not found in 'Welcome to nginx!'</pre>
</div>
</div>
<div class="paragraph">
<p>Progress!



</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploying_our_code_manually">Deploying Our Code Manually</h3>
<div class="paragraph">
<p>The next step is to get a copy of the staging site up and running, just to
check whether we can get Nginx and Django to talk to each other.  As we do so,
we&#8217;re starting to move into doing "deployment" rather than provisioning, so we
should be thinking about how we can automate the process, as we go.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
One rule of thumb for distinguishing provisioning from deployment is
that you tend to need root permissions for the former, but we don&#8217;t for the
latter.


</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We need a directory for the source to live in.  Let&#8217;s assume we have a home
folder for a nonroot user; in my case it would be at <em>/home/elspeth</em> (this is
likely to be the setup on any shared hosting system, but you should always run
your web apps as a nonroot user, in any case). I&#8217;m going to set up my
sites like this:</p>
</div>
<div class="listingblock skipme">
<div class="content">
<pre>/home/elspeth
&#9500;&#9472;&#9472; sites
&#9474;&#160;&#160; &#9500;&#9472;&#9472; www.live.my-website.com
&#9474;&#160;&#160; &#9474;    &#9500;&#9472;&#9472; database
&#9474;&#160;&#160; &#9474;    &#9474;     &#9492;&#9472;&#9472; db.sqlite3
&#9474;&#160;&#160; &#9474;    &#9500;&#9472;&#9472; source
&#9474;&#160;&#160; &#9474;    &#9474;    &#9500;&#9472;&#9472; manage.py
&#9474;&#160;&#160; &#9474;    &#9474;    &#9500;&#9472;&#9472; superlists
&#9474;&#160;&#160; &#9474;    &#9474;    &#9500;&#9472;&#9472; etc...
&#9474;&#160;&#160; &#9474;    &#9474;
&#9474;&#160;&#160; &#9474;    &#9500;&#9472;&#9472; static
&#9474;&#160;&#160; &#9474;    &#9474;    &#9500;&#9472;&#9472; base.css
&#9474;&#160;&#160; &#9474;    &#9474;    &#9500;&#9472;&#9472; etc...
&#9474;&#160;&#160; &#9474;    &#9474;
&#9474;&#160;&#160; &#9474;    &#9492;&#9472;&#9472; virtualenv
&#9474;&#160;&#160; &#9474;         &#9500;&#9472;&#9472; lib
&#9474;&#160;&#160; &#9474;         &#9500;&#9472;&#9472; etc...
&#9474;&#160;&#160; &#9474;
&#9474;&#160;&#160; &#9500;&#9472;&#9472; www.staging.my-website.com
&#9474;&#160;&#160; &#9474;    &#9500;&#9472;&#9472; database
&#9474;&#160;&#160; &#9474;    &#9500;&#9472;&#9472; etc...</pre>
</div>
</div>
<div class="paragraph">
<p>Each site (staging, live, or any other website) has its own folder. Within that
we have a separate folder for the source code, the database, and the static
files.  The logic is that, while the source code might change from one version
of the site to the next, the database will stay the same.  The static folder
is in the same relative location, <em>../static</em>, that we set up at the end of
the last chapter. Finally, the virtualenv gets its own subfolder too.  What&#8217;s a
virtualenv, I hear you ask? We&#8217;ll find out shortly.</p>
</div>
<div class="sect3">
<h4 id="_adjusting_the_database_location">Adjusting the Database Location</h4>
<div class="paragraph">
<p>

First let&#8217;s change the location of our database in <em>settings.py</em>, and make sure
we can get that working on our local PC:</p>
</div>
<div class="listingblock sourcecode">
<div class="title">superlists/settings.py (ch08l003)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="comment"># Build paths inside the project like this: os.path.join(BASE_DIR, ...)</span>
<span class="keyword">import</span> <span class="include">os</span>
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
[...]

DATABASES = {
    <span class="string"><span class="delimiter">'</span><span class="content">default</span><span class="delimiter">'</span></span>: {
        <span class="string"><span class="delimiter">'</span><span class="content">ENGINE</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">django.db.backends.sqlite3</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">NAME</span><span class="delimiter">'</span></span>: os.path.join(BASE_DIR, <span class="string"><span class="delimiter">'</span><span class="content">../database/db.sqlite3</span><span class="delimiter">'</span></span>),
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Check out the way <code>BASE_DIR</code> is defined, further up in <em>settings.py</em>.
Notice the <code>abspath</code> gets done first (i.e., innermost).  Always follow this
pattern when path-wrangling, otherwise you can see strange things happening
depending on how the file is imported.  Thanks to
<a href="https://github.com/CleanCut/green">Green Nathan</a> for that tip!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now let&#8217;s try it locally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>mkdir ../database</strong>
$ <strong>python3 manage.py migrate --noinput</strong>
Creating tables ...
[...]
$ <strong>ls ../database/</strong>
db.sqlite3</pre>
</div>
</div>
<div class="paragraph">
<p>That seems to work.  Let&#8217;s commit it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git diff</strong> # should show changes in settings.py
$ <strong>git commit -am "move sqlite database outside of main source tree"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>To get our code onto the server, we&#8217;ll use Git and go via one of the code
sharing sites.  If you haven&#8217;t already, push your code up to GitHub, BitBucket,
or similar.  They all have excellent instructions for beginners on how to
do that.</p>
</div>
<div class="paragraph">
<p>
Here&#8217;s some bash commands that will set this all up. If you&#8217;re not familiar
with it, note the <code>export</code> command which lets me set up a "local variable"
in bash:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>export SITENAME=superlists-staging.ottg.eu</strong>
elspeth@server:$ <strong>mkdir -p ~/sites/$SITENAME/database</strong>
elspeth@server:$ <strong>mkdir -p ~/sites/$SITENAME/static</strong>
elspeth@server:$ <strong>mkdir -p ~/sites/$SITENAME/virtualenv</strong>
# you should replace the URL in the next line with the URL for your own repo
elspeth@server:$ <strong>git clone https://github.com/hjwp/book-example.git \
~/sites/$SITENAME/source</strong>
Resolving deltas: 100% [...]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A bash variable defined using <code>export</code> only lasts as long as that console
session. If you log out of the server and log back in again, you&#8217;ll need to
redefine it. It&#8217;s devious because Bash won&#8217;t error, it will just substitute
the empty string for the variable, which will lead to weird results&#8230;&#8203;if in
doubt, do a quick <strong><code>echo $SITENAME</code></strong>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now we&#8217;ve got the site installed, let&#8217;s just try running the dev server&#8212;&#8203;this
is a smoke test, to see if all the moving parts are connected:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ $ <strong>cd ~/sites/$SITENAME/source</strong>
$ <strong>python3 manage.py runserver</strong>
Traceback (most recent call last):
  File "manage.py", line 8, in &lt;module&gt;
    from django.core.management import execute_from_command_line
ImportError: No module named django.core.management</pre>
</div>
</div>
<div class="paragraph">
<p>Ah. Django isn&#8217;t installed on the server.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_virtualenv">Creating a Virtualenv</h4>
<div class="paragraph">
<p>


We could install it at this point, but that would leave us with a problem:  if
we ever wanted to upgrade Django when a new version comes out, it would be
impossible to test the staging site with a different version from live.
Similarly, if there are other users on the server, we&#8217;d all be forced to use
the same version of Django.</p>
</div>
<div class="paragraph">
<p>
The solution is a "virtualenv"&#8212;a neat way of having different versions of
Python packages installed in different places, in their own "virtual
environments".</p>
</div>
<div class="paragraph">
<p>Let&#8217;s try it out locally, on our own PC first:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>pip3 install virtualenv</strong> # will need a sudo on linux/macos.</pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ll follow the same folder structure as we&#8217;re planning for the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>virtualenv --python=python3 ../virtualenv</strong>
$ <strong>ls ../virtualenv/</strong>
bin  include  lib</pre>
</div>
</div>
<div class="paragraph">
<p>That will create a folder at <em>../virtualenv</em> which will contain its own
copy of Python and <code>pip</code>, as well as a location to install Python packages
to.  It&#8217;s a self-contained &#8220;virtual&#8221; Python environment.  To start using
it, we run a script called <code>activate</code>, which will change the system path
and the Python path in such a way as to use the virtualenv&#8217;s executables
and packages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>which python3</strong>
/usr/bin/python3
$ <strong>source ../virtualenv/bin/activate</strong>
$ <strong>which python</strong>  # note switch to virtualenv Python
/workspace/virtualenv/bin/python
(virtualenv)$ <strong>python3 manage.py test lists</strong>
[...]
ImportError: No module named 'django'</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It&#8217;s not required, but you might want to look into a tool called
<code>virtualenvwrapper</code> for managing virtualenvs on your own PC.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Virtualenvs on Windows</div>
<div class="paragraph">
<p>On Windows, things are slightly different. There are two main things to watch
out for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>virtualenv/bin</em> folder is called <em>virtualenv/Scripts</em>, so you should
substitute that in as appropriate.</p>
</li>
<li>
<p>When using Git-Bash, do not try and run %%activate.bat%%&#8212;it is written for
the DOS shell.  Use <code>source ..\virtualenv\Scripts\activate</code>.  The <code>source</code> is
important.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>We&#8217;re seeing that <code>ImportError: No module named django</code> because Django isn&#8217;t
installed inside the virtualenv.  So, we can install it, and see that it
ends up inside the virtualenv&#8217;s <em>site-packages</em> folder:</p>
</div>
<div class="listingblock small-code">
<div class="content">
<pre>(virtualenv)$ <strong>pip install "django&lt;1.9"</strong>
[...]
Successfully installed django
Cleaning up...
(virtualenv)$ <strong>python3 manage.py test lists</strong>
[...]
OK
$ <strong>ls ../virtualenv/lib/python3.4/site-packages/</strong>
django                       pip                     setuptools
Django-1.8.11.dist-info  py-1.4.31.dist-info  setuptools-18.2.dist-info
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>To "save" the list of packages we need in our virtualenv, and be able to
re-create it later, we create a <em>requirements.txt</em> file, using <code>pip freeze</code>,
and add that to our repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(virtualenv)$ <strong>pip freeze &gt; requirements.txt</strong>
(virtualenv)$ <strong>deactivate</strong>
$ <strong>cat requirements.txt</strong>
Django==1.8.11
$ <strong>git add requirements.txt</strong>
$ <strong>git commit -m "Add requirements.txt for virtualenv"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>And now we do a <code>git push</code> to send our updates up to our code-sharing site:</p>
</div>
<div class="listingblock skipme">
<div class="content">
<pre>$ <strong>git push</strong></pre>
</div>
</div>
<div class="paragraph">
<p>And we can pull those changes down to the server, create a virtualenv on
the server, and use <em>requirements.txt</em> along with <code>pip install -r</code> to
make the server virtualenv just like our local one:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>git pull</strong>  # may ask you to do some git config first
elspeth@server:$ <strong>virtualenv --python=python3 ../virtualenv/</strong>
elspeth@server:$ <strong>../virtualenv/bin/pip install -r requirements.txt</strong>
Downloading/unpacking Django==1.8 (from -r requirements.txt (line 1))
[...]
Successfully installed Django
Cleaning up...
elspeth@server:$ <strong>../virtualenv/bin/python3 manage.py runserver</strong>
Validating models...
0 errors found
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>That looks like it&#8217;s running happily.  We can Ctrl-C it for now.</p>
</div>
<div class="paragraph">
<p>Notice you don&#8217;t have to use the <code>activate</code> to use the virtualenv.
Directly specifying the path to the virtualenv copies of <code>python</code> or
<code>pip</code> works too.  We&#8217;ll use the direct paths on the server.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Most people like to create a virtualenv for a project as soon
as they start it.  I only waited until now because I wanted to keep
the first few chapters as simple as possible.



</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_simple_nginx_configuration">Simple Nginx Configuration</h4>
<div class="paragraph">
<p>

Next we create an Nginx config file to tell it to send requests for our staging
site along to Django. A minimal config looks like this:</p>
</div>
<div class="listingblock sourcecode">
<div class="title">server: /etc/nginx/sites-available/superlists-staging.ottg.eu</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="nginx">server {
    listen 80;
    server_name superlists-staging.ottg.eu;

    location / {
        proxy_pass http://localhost:8000;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This config says it will only work for our staging domain, and will "proxy"
all requests to the local port 8000 where it expects to find Django
waiting to respond to requests.</p>
</div>
<div class="paragraph">
<p>I
saved<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnote_3" title="View footnote.">3</a>]</sup>
this to a file called <em>superlists-staging.ottg.eu</em>
inside <em>/etc/nginx/sites-available</em> folder, and then added it to the enabled
sites for the server by creating a symlink to it:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>echo $SITENAME</strong> # check this still has our site in
superlists-staging.ottg.eu
elspeth@server:$ <strong>sudo ln -s ../sites-available/$SITENAME \
/etc/nginx/sites-enabled/$SITENAME</strong>
elspeth@server:$ <strong>ls -l /etc/nginx/sites-enabled</strong> # check our symlink is there</pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s the Debian/Ubuntu preferred way of saving Nginx configurations&#8212;&#8203;the real
config file in <em>sites-available</em>, and a symlink in <em>sites-enabled</em>; the idea is
that it makes it easier to switch sites on or off.</p>
</div>
<div class="paragraph">
<p>We also may as well remove the default "Welcome to nginx" config, to avoid any
confusion:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>sudo rm /etc/nginx/sites-enabled/default</strong></pre>
</div>
</div>
<div class="paragraph">
<p>And now to test it:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>sudo systemctl reload nginx</strong>
elspeth@server:$ <strong>../virtualenv/bin/python3 manage.py runserver</strong></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
I also had to edit <em>/etc/nginx/nginx.conf</em> and uncomment a line saying
<code>server_names_hash_bucket_size 64;</code> to get my long domain name to work.  You
may not have this problem; Nginx will warn you when you do a <code>reload</code> if it has
any trouble with its config files.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A quick visual inspection confirms&#8212;&#8203;the site is up (<a href="#staging-is-up">The staging site is up!</a>)!</p>
</div>
<div id="staging-is-up" class="imageblock">
<div class="content">
<img src="images/twdp_0803.png" alt="The front page of the site, at least, is up">
</div>
<div class="title">Figure 3. The staging site is up!</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you ever find Nginx isn&#8217;t behaving as expected, try the command
<code>sudo nginx -t</code>, which does a config test, and will warn you of any
problems in your configuration files.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s see what our functional tests say:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>python3 manage.py test functional_tests --liveserver=superlists-staging.ottg.eu</strong>
[...]
selenium.common.exceptions.NoSuchElementException: Message: Unable to locate
[...]
AssertionError: 0.0 != 512 within 3 delta</pre>
</div>
</div>
<div class="paragraph">
<p>

The tests are failing as soon as they try and submit a new item, because we
haven&#8217;t set up the database. You&#8217;ll probably have spotted the yellow Django
debug page (<a href="#django-debug-screen">But the database isn&#8217;t</a>) telling us as much as the tests went
through, or if you tried it manually.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The tests saved us from potential embarrassment there.  The site <em>looked</em>
fine when we loaded its front page.  If we&#8217;d been a little hasty, we might have
thought we were done, and it would have been the first users that discovered
that nasty Django DEBUG page.  Okay, slight exaggeration for effect, maybe we
<em>would</em> have checked, but what happens as the site gets bigger and more
complex? You can&#8217;t check everything. The tests can.


</td>
</tr>
</table>
</div>
<div id="django-debug-screen" class="imageblock">
<div class="content">
<img src="images/twdp_0804.png" alt="Django DEBUG page showing database error">
</div>
<div class="title">Figure 4. But the database isn&#8217;t</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_the_database_with_migrate">Creating the Database with migrate</h4>
<div class="paragraph">
<p>

We run <code>migrate</code> using the <code>--noinput</code> argument to suppress the two little "are
you sure" prompts:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>../virtualenv/bin/python3 manage.py migrate --noinput</strong>
Creating tables ...
[...]
elspeth@server:$ <strong>ls ../database/</strong>
db.sqlite3
elspeth@server:$ <strong>../virtualenv/bin/python3 manage.py runserver</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s try the FTs again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>python3 manage.py test functional_tests --liveserver=superlists-staging.ottg.eu</strong>
Creating test database for alias 'default'...
..
 ---------------------------------------------------------------------
Ran 2 tests in 10.718s

OK
Destroying test database for alias 'default'...</pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s great to see the site up and running!  We might reward ourselves with a
well-earned tea break at this point, before moving on to the next section&#8230;&#8203;</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you see a "502 - Bad Gateway", it&#8217;s probably because you forgot to
restart the dev server with <code>manage.py runserver</code> after the <code>migrate</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_to_a_production_ready_deployment">Getting to a Production-Ready Deployment</h3>
<div class="paragraph">
<p>
We&#8217;re at least reassured that the basic piping works, but we really can&#8217;t be
using the Django dev server in production.  We also can&#8217;t be relying on
manually starting it up with <code>runserver</code>.</p>
</div>
<div class="sect3">
<h4 id="_switching_to_gunicorn">Switching to Gunicorn</h4>
<div class="paragraph">
<p>

Do you know why the Django mascot is a pony?  The story is that Django
comes with so many things you want: an ORM, all sorts of middleware,
the admin site&#8230;&#8203; "What else do you want, a pony?" Well, Gunicorn stands
for "Green Unicorn", which I guess is what you&#8217;d want next if you already
had a pony&#8230;&#8203;</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>../virtualenv/bin/pip install gunicorn</strong></pre>
</div>
</div>
<div class="paragraph">
<p>Gunicorn will need to know a path to a WSGI server, which is usually
a function called <code>application</code>.  Django provides one in <em>superlists/wsgi.py</em>:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>../virtualenv/bin/gunicorn superlists.wsgi:application</strong>
2013-05-27 16:22:01 [10592] [INFO] Starting gunicorn 0.18.0
2013-05-27 16:22:01 [10592] [INFO] Listening at: http://127.0.0.1:8000 (10592)
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>If you now take a look at the site, you&#8217;ll find the CSS is all broken, as in
<a href="#site-with-broken-css">Broken CSS</a>.</p>
</div>
<div class="paragraph">
<p>
And if we run the functional tests, you&#8217;ll see they confirm that something
is wrong. The test for adding list items passes happily, but the test for
layout + styling fails.  Good job tests!</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>python3 manage.py test functional_tests --liveserver=superlists-staging.ottg.eu</strong>
[...]
AssertionError: 125.0 != 512 within 3 delta
FAILED (failures=1)</pre>
</div>
</div>
<div class="paragraph">
<p>The reason that the CSS is broken is that although the Django dev server will
serve static files magically for you, Gunicorn doesn&#8217;t.  Now is the time to
tell Nginx to do it instead.</p>
</div>
<div id="site-with-broken-css" class="imageblock">
<div class="content">
<img src="images/twdp_0805.png" alt="The site is up, but CSS is broken">
</div>
<div class="title">Figure 5. Broken CSS</div>
</div>
</div>
<div class="sect3">
<h4 id="_getting_nginx_to_serve_static_files">Getting Nginx to Serve Static Files</h4>
<div class="paragraph">
<p>

First we run <code>collectstatic</code> to copy all the static files to a folder where
Nginx can find them:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>../virtualenv/bin/python3 manage.py collectstatic --noinput</strong>
elspeth@server:$ <strong>ls ../static/</strong>
base.css  bootstrap</pre>
</div>
</div>
<div class="paragraph">
<p>Note that, again, instead of using the virtualenv <code>activate</code> command, we
can use the direct path to the virtualenv&#8217;s copy of Python instead.</p>
</div>
<div class="paragraph">
<p>Now we tell Nginx to start serving those static files for us:</p>
</div>
<div class="listingblock sourcecode">
<div class="title">server: /etc/nginx/sites-available/superlists-staging.ottg.eu</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="nginx">server {
    listen 80;
    server_name superlists-staging.ottg.eu;

    location /static {
        alias /home/elspeth/sites/superlists-staging.ottg.eu/static;
    }

    location / {
        proxy_pass http://localhost:8000;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Reload Nginx and restart Gunicorn&#8230;&#8203;</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>sudo systemctl reload nginx</strong>
elspeth@server:$ <strong>../virtualenv/bin/gunicorn superlists.wsgi:application</strong></pre>
</div>
</div>
<div class="paragraph">
<p>And if we take another look at the site, things are looking much healthier. We
can rerun our FTs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>python3 manage.py test functional_tests --liveserver=superlists-staging.ottg.eu</strong>
Creating test database for alias 'default'...
..
 ---------------------------------------------------------------------
Ran 2 tests in 10.718s

OK
Destroying test database for alias 'default'...</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_switching_to_using_unix_sockets">Switching to Using Unix Sockets</h4>
<div class="paragraph">
<p>
When we want to serve both staging and live, we can&#8217;t have both servers trying
to use port 8000.  We could decide to allocate different ports, but that&#8217;s a
bit arbitrary, and it would be dangerously easy to get it wrong and start
the staging server on the live port, or vice versa.</p>
</div>
<div class="paragraph">
<p>A better solution is to use Unix domain sockets&#8212;&#8203;they&#8217;re like files on disk,
but can be used by Nginx and Gunicorn to talk to each other.  We&#8217;ll put our
sockets in <em>/tmp</em>.  Let&#8217;s change the proxy settings in Nginx:</p>
</div>
<div class="listingblock sourcecode">
<div class="title">server: /etc/nginx/sites-available/superlists-staging.ottg.eu</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="nginx">[...]
    location / {
        proxy_set_header Host $host;
        proxy_pass http://unix:/tmp/superlists-staging.ottg.eu.socket;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>proxy_set_header</code> is used to make sure Gunicorn and Django know what domain
it&#8217;s running on.  We need that for the <code>ALLOWED_HOSTS</code> security feature, which
we&#8217;re about to switch on.</p>
</div>
<div class="paragraph">
<p>Now we restart Gunicorn, but this time telling it to listen on a socket instead
of on the default port:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre>elspeth@server:$ <strong>sudo systemctl reload nginx</strong>
elspeth@server:$ <strong>../virtualenv/bin/gunicorn --bind \
    unix:/tmp/superlists-staging.ottg.eu.socket superlists.wsgi:application</strong></pre>
</div>
</div>
<div class="paragraph">
<p>And again, we rerun the functional test again, to make sure things still pass:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>python3 manage.py test functional_tests --liveserver=superlists-staging.ottg.eu</strong>
OK</pre>
</div>
</div>
<div class="paragraph">
<p>A couple more steps!</p>
</div>
</div>
<div class="sect3">
<h4 id="_switching_debug_to_false_and_setting_allowed_hosts">Switching DEBUG to False and Setting ALLOWED_HOSTS</h4>
<div class="paragraph">
<p>


Django&#8217;s DEBUG mode is all very well for hacking about on your own server, but
leaving those pages full of tracebacks available
<a href="http://bit.ly/SuvluV">isn&#8217;t secure</a>.</p>
</div>
<div class="paragraph">
<p>You&#8217;ll find the <code>DEBUG</code> setting at the top of <em>settings.py</em>. When we set this
to <code>False</code>, we also need to set another setting called <code>ALLOWED_HOSTS</code>. This
was
<a href="https://docs.djangoproject.com/en/1.8/ref/settings/#std:setting-ALLOWED_HOSTS">added
as a security feature</a> in Django 1.5.  Unfortunately it doesn&#8217;t have a helpful
comment in the default <em>settings.py</em>, but we can add one ourselves.  Do this on
the server:</p>
</div>
<div class="listingblock sourcecode">
<div class="title">server: superlists/settings.py</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="comment"># SECURITY WARNING: don't run with debug turned on in production!</span>
DEBUG = <span class="predefined-constant">False</span>

TEMPLATE_DEBUG = DEBUG

<span class="comment"># Needed when DEBUG=False</span>
ALLOWED_HOSTS = [<span class="string"><span class="delimiter">'</span><span class="content">superlists-staging.ottg.eu</span><span class="delimiter">'</span></span>]
[...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>And, once again, we restart Gunicorn and run the FT to check things still work.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Don&#8217;t commit these changes on the server. At the moment this is just a
hack to get things working, not a change we want to keep in our repo. In
general, to keep things simple, I&#8217;m only going to do Git commits from the local
PC, using <code>git push</code> and <code>git pull</code> when I need to sync them up to the server.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_using_systemd_to_make_sure_gunicorn_starts_on_boot">Using Systemd to Make Sure Gunicorn Starts on Boot</h4>
<div class="paragraph">
<p>
Our final step is to make sure that the server starts up Gunicorn automatically
on boot, and reloads it automatically if it crashes.  On Ubuntu, the way to do
this is using Systemd:</p>
</div>
<div class="listingblock sourcecode">
<div class="title">server: /etc/systemd/system/gunicorn-superlists-staging.ottg.eu.service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">[Unit]
Description=Gunicorn server for superlists-staging.ottg.eu

[Service]
Restart=on-failure  <i class="conum" data-value="1"></i><b>(1)</b>
User=elspeth  <i class="conum" data-value="2"></i><b>(2)</b>
WorkingDirectory=/home/elspeth/sites/superlists-staging.ottg.eu/source  <i class="conum" data-value="3"></i><b>(3)</b>
ExecStart=/home/elspeth/sites/superlists-staging.ottg.eu/virtualenv/bin/gunicorn \
    --bind unix:/tmp/superlists-staging.ottg.eu.socket \
    superlists.wsgi:application  <i class="conum" data-value="4"></i><b>(4)</b>

[Install]
WantedBy=multi-user.target <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>Systemd is joyously simple to configure (especially if you&#8217;ve ever had the
dubious pleasure of writing an <code>init.d</code> script), and is fairly
self-explanatory.</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>Restart=on-failure</code> will restart the process automatically if it crashes.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>User=elspeth</code> makes the process run as the "elspeth" user.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>WorkingDirectory</code> sets the working directory.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>ExecStart</code> is the actual process to execute.  We use the `\ ` line
continuation characters to split the full command over multiple lines,
for readability, but it could all go on one line.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>WantedBy</code> in the <code>[Install]</code> section is what tells Systemd we want this
service to start on boot.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Systemd scripts live in <em>/etc/systemd/system</em>, and their names must end in
<em>.service</em>.</p>
</div>
<div class="paragraph">
<p>Now we tell Systemd to start Gunicorn with the <code>systemctl</code> command:</p>
</div>
<div class="listingblock server-commands">
<div class="content">
<pre># this command is necessary to tell Systemd to load our new config file
elspeth@server:$ <strong>sudo systemctl daemon-reload</strong>
# this command tells Systemd to always load our service on boot
elspeth@server:$ <strong>sudo systemctl enable gunicorn-superlists-staging.ottg.eu</strong>
# this command actually starts our service
elspeth@server:$ <strong>sudo systemctl start gunicorn-superlists-staging.ottg.eu</strong></pre>
</div>
</div>
<div class="paragraph">
<p>(you should find the <code>systemctl</code> command responds to tab-completion, including
of the service name, by the way)</p>
</div>
<div class="paragraph">
<p>Now we can rerun the FTs to see that everything still works. You can even test
that the site comes back up if you reboot the server!</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Debugging Tips</div>
<div class="paragraph">
<p>Deployments are tricky!  If ever things don&#8217;t go exactly as expected, here are
a few tips and things to look out for:
</p>
</div>
<div class="ulist">
<ul>
<li>
<p>I&#8217;m sure you already have, but double-check that each file is exactly where
it should be and has the right contents&#8212;&#8203;a single stray character can make
all the difference.</p>
</li>
<li>
<p>Nginx error logs go into <em>/var/log/nginx/error.log</em>.</p>
</li>
<li>
<p>You can ask Nginx to "check" its config using the -t flag:</p>
<div class="literalblock">
<div class="content">
<pre>nginx -t</pre>
</div>
</div>
</li>
<li>
<p>You can ask Ubuntu to check the validity of your init script with
<a href="http://manpages.ubuntu.com/manpages/precise/man8/init-checkconf.8.html">init-checkconf</a></p>
</li>
<li>
<p>Check the Systemd logs for using
<code>sudo journalctl -u gunicorn-superlists-staging.ottg.eu</code></p>
</li>
<li>
<p>Remember to restart both services whenever you make changes.</p>
</li>
<li>
<p>If you make changes to the Systemd config file, you need to
run <code>daemon-reload</code> before <code>systemctl restart</code> to see the effect
of your changes.</p>
</li>
<li>
<p>Make sure your browser isn&#8217;t caching an out-of-date response.  Use
Ctrl+Refresh, or start a new private browser window.</p>
</li>
<li>
<p>This may be clutching at straws, but I&#8217;ve sometimes seen inexplicable
behaviour on the server that&#8217;s only been resolved when I fully restarted it
with a <code>sudo reboot</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you ever get completely stuck, there&#8217;s always the option of blowing away
your server and starting again from scratch!  It should go faster the second
time&#8230;&#8203;</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_saving_our_changes_adding_gunicorn_to_our_requirements_txt">Saving Our Changes: Adding Gunicorn to Our requirements.txt</h4>
<div class="paragraph">
<p>Back in the <em>local</em> copy of your repo, we should add Gunicorn to the list
of packages we need in our virtualenvs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>source ../virtualenv/bin/activate</strong> # if necessary
(virtualenv)$ pip install gunicorn
(virtualenv)$ <strong>pip freeze &gt; requirements.txt</strong>
(virtualenv)$ deactivate
$ <strong>git commit -am "Add gunicorn to virtualenv requirements"</strong>
$ <strong>git push</strong></pre>
</div>
</div>
<div class="paragraph">
<p></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
On Windows, at the time of writing, Gunicorn would pip install quite
happily, but it wouldn&#8217;t actually work if you tried to use it.  Thankfully
we only ever run it on the server, so that&#8217;s not a problem. And, Windows
support is
<a href="http://stackoverflow.com/questions/11087682/does-gunicorn-run-on-windows">being
discussed</a>&#8230;&#8203;
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_automating">Automating</h3>
<div class="paragraph">
<p>


Let&#8217;s recap our provisioning and deployment procedures:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Provisioning</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Assume we have a user account and home folder</p>
</li>
<li>
<p><code>apt-get install nginx git python-pip</code></p>
</li>
<li>
<p><code>pip install virtualenv</code></p>
</li>
<li>
<p>Add Nginx config for virtual host</p>
</li>
<li>
<p>Add Systemd job for Gunicorn</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1">Deployment</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create directory structure in <em>~/sites</em></p>
</li>
<li>
<p>Pull down source code into folder named <em>source</em></p>
</li>
<li>
<p>Start virtualenv in <em>../virtualenv</em></p>
</li>
<li>
<p><code>pip install -r requirements.txt</code></p>
</li>
<li>
<p><code>manage.py migrate</code> for database</p>
</li>
<li>
<p><code>collectstatic</code> for static files</p>
</li>
<li>
<p>Set DEBUG = False and ALLOWED_HOSTS in <em>settings.py</em></p>
</li>
<li>
<p>Restart Gunicorn job</p>
</li>
<li>
<p>Run FTs to check everything works</p>
</li>
</ol>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Assuming we&#8217;re not ready to entirely automate our provisioning process, how
should we save the results of our investigation so far?  I would say that
the Nginx and Systemd config files should probably be saved somewhere, in
a way that makes it easy to reuse them later.  Let&#8217;s save them in a new
subfolder in our repo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>mkdir deploy_tools</strong></pre>
</div>
</div>
<div class="listingblock sourcecode">
<div class="title">deploy_tools/nginx.template.conf</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="nginx">server {
    listen 80;
    server_name SITENAME;

    location /static {
        alias /home/elspeth/sites/SITENAME/static;
    }

    location / {
        proxy_set_header Host $host;
        proxy_pass http://unix:/tmp/SITENAME.socket;
    }
}</code></pre>
</div>
</div>
<div class="listingblock sourcecode">
<div class="title">deploy_tools/gunicorn-systemd.template.service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">[Unit]
Description=Gunicorn server for SITENAME

[Service]
Restart=on-failure
User=elspeth
WorkingDirectory=/home/elspeth/sites/SITENAME/source
ExecStart=/home/elspeth/sites/SITENAME/virtualenv/bin/gunicorn \
    --bind unix:/tmp/SITENAME.socket \
    superlists.wsgi:application

[Install]
WantedBy=multi-user.target</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then it&#8217;s easy for us to use those two files to generate
a new site, by doing a find &amp; replace on  <code>SITENAME</code>.</p>
</div>
<div class="paragraph">
<p>For the rest, just keeping a few notes is OK. Why not keep
them in a file in the repo too?</p>
</div>
<div class="listingblock sourcecode">
<div class="title">deploy_tools/provisioning_notes.md</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="rst">Provisioning a new site
=======================

## Required packages:

* nginx
* Python 3
* Git
* pip
* virtualenv

e.g.,, on Ubuntu:

    sudo apt-get install nginx git python3 python3-pip
    sudo pip3 install virtualenv

## Nginx Virtual Host config

* see nginx.template.conf
* replace SITENAME with, e.g., staging.my-domain.com

## Systemd service

* see gunicorn-systemd.template.service
* replace SITENAME with, e.g., staging.my-domain.com

## Folder structure:
Assume we have a user account at /home/username

/home/username
&#9492;&#9472;&#9472; sites
 &#160;&#160; &#9492;&#9472;&#9472; SITENAME
 &#160;&#160;      &#9500;&#9472;&#9472; database
 &#160;&#160;      &#9500;&#9472;&#9472; source
 &#160;&#160;      &#9500;&#9472;&#9472; static
 &#160;&#160;      &#9492;&#9472;&#9472; virtualenv</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can do a commit for those:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>git add deploy_tools</strong>
$ <strong>git status</strong> # see three new files
$ <strong>git commit -m "Notes and template config files for provisioning"</strong></pre>
</div>
</div>
<div class="paragraph">
<p>

Our source tree will now look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ tree -I __pycache__
.
&#9500;&#9472;&#9472; deploy_tools
&#9474;&#160;&#160; &#9500;&#9472;&#9472; gunicorn-systemd.template.service
&#9474;&#160;&#160; &#9500;&#9472;&#9472; nginx.template.conf
&#9474;&#160;&#160; &#9492;&#9472;&#9472; provisioning_notes.md
&#9500;&#9472;&#9472; functional_tests
&#9474;&#160;&#160; &#9500;&#9472;&#9472; __init__.py
&#9474;&#160;&#160; &#9500;&#9472;&#9472; [...]
&#9500;&#9472;&#9472; lists
&#9474;&#160;&#160; &#9500;&#9472;&#9472; __init__.py
&#9474;&#160;&#160; &#9500;&#9472;&#9472; models.py
&#9474;&#160;&#160; &#9500;&#9472;&#9472; static
&#9474;&#160;&#160; &#9474;   &#9500;&#9472;&#9472; base.css
&#9474;&#160;&#160; &#9474;   &#9500;&#9472;&#9472; [...]
&#9474;&#160;&#160; &#9500;&#9472;&#9472; templates
&#9474;&#160;&#160; &#9474;   &#9500;&#9472;&#9472; base.html
&#9474;&#160;&#160; &#9474;   &#9500;&#9472;&#9472; [...]
&#9500;&#9472;&#9472; manage.py
&#9500;&#9472;&#9472; requirements.txt
&#9492;&#9472;&#9472; superlists
 &#160;&#160; &#9500;&#9472;&#9472; [...]</pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Test-Driving Server Configuration and Deployment</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Tests take some of the uncertainty out of deployment</dt>
<dd>
<p>As developers, server administration is always "fun", by which I mean, a
process full of uncertainty and surprises. My aim during this chapter was
to show a functional test suite can take some of the uncertainty out of the
process.

</p>
</dd>
<dt class="hdlist1">Typical pain points&#8212;&#8203;database, static files, dependencies, custom settings</dt>
<dd>
<p>The things that you need to keep an eye out on any deployment include
your database configuration, static files, software dependencies, and
custom settings that differ between development and production.  You&#8217;ll
need to think through each of these for your own deployments.</p>
</dd>
<dt class="hdlist1">Tests allow us to experiment</dt>
<dd>
<p>Whenever we make a change to our server configuration, we can rerun the
test suite, and be confident that everything works as well as it did
before.  It allows us to experiment with our setup with less fear.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__saving_your_progress">"Saving Your Progress"</h4>
<div class="paragraph">
<p>
Being able to run our FTs against a staging server can be very reassuring.
But, in most cases, you don&#8217;t want to run your FTs against your "real" server.
In order to "save our work", and reassure ourselves that the production server
will work just as well as the real server, we need to make our deployment
process repeatable.</p>
</div>
<div class="paragraph">
<p>Automation is the answer, and it&#8217;s the topic of the next chapter.
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. What I&#8217;m calling a "staging" server, some people would call a "development" server, and some others would also like to distinguish "preproduction" servers.  Whatever we call it, the point is to have somewhere we can try our code out in an environment that&#8217;s as similar as possible to the real production server.
</div>
<div class="footnote" id="_footnote_2">
<a href="#_footnoteref_2">2</a>. If you&#8217;re not familiar <code>super()</code> and the way Python inheritance works, you can go away and spend a bit of time researching it now if you like.  Learn Python the Hard Way has <a href="http://learnpythonthehardway.org/book/ex44.html">a good chapter on it</a>. Or just take it on faith!
</div>
<div class="footnote" id="_footnote_3">
<a href="#_footnoteref_3">3</a>. Not sure how to edit a file on the server?  There&#8217;s always vi, which I&#8217;ll keep encouraging you to learn a bit of. Alternatively, try the relatively beginner-friendly <code>nano</code>. Note you&#8217;ll also need to use <code>sudo</code> because the file is in a system folder.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-11-03 07:09:13 GMT
</div>
</div>
<div class="comments" style="padding: 20px">
  <h3>Comments</h3>
  <div id="disqus_thread"></div>

  <script type="text/javascript">
var disqus_shortname = 'obeythetestinggoat';
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
  </script>

  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
<html><head><script>   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){   (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)   })(window,document,'script','//www.google-analytics.com/analytics.js','ga');    ga('create', 'UA-40928035-1', 'obeythetestinggoat.com');   ga('send', 'pageview');  </script>
</head></html></body>
</html>