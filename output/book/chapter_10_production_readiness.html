<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<title>Making our App Production-Ready</title>
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
<script>var httpRequest = new XMLHttpRequest();
httpRequest.onreadystatechange = function() {
  if (httpRequest.readyState === XMLHttpRequest.DONE) {
    if (httpRequest.status === 200) {
      document.getElementById('header').innerHTML += httpRequest.responseText;
      var subheaders = document.getElementsByClassName('sectlevel2');
      var section;
      for (var i=0; i<subheaders.length; i++) {
        section = subheaders[i];
        if (section.innerHTML.indexOf(window.location.pathname) === -1) {
          section.style.display = 'none';
        } else {
          section.scrollIntoView && section.scrollIntoView();
        }
      }

    }
  }
};
httpRequest.open('GET', 'toc.html');
httpRequest.send();

</script></head>
<body class="article toc2 toc-left">
<div id="buy_the_book" style="position: absolute; top: 0; right: 0; z-index:100">
  <a href="/pages/book.html">
    <img src="images/buy_the_book.svg" alt="buy the book ribbon">
  </a>
</div>
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="chapter_10_production_readiness">Making our App Production-Ready</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our container is working fine but it&#8217;s not production-ready.
Let&#8217;s try to get it there, using the tests to keep us safe.</p>
</div>
<div class="paragraph">
<p>In a way we&#8217;re applying the Red-Green-Refactor cycle to our productionisation process.
Our hacky container config got us to Green, and now we&#8217;re going to Refactor,
working incrementally (just as we would while coding),
trying to move from working state to working state,
and using the FTs to detect any regressions.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">&#128679; Warning, chapter under construction &#128679;</div>
<div class="paragraph">
<p>As part of my work on the third edition of the book,
I&#8217;m making big changes to the deployment chapters,
and this is a very new draft.</p>
</div>
<div class="paragraph">
<p>This chapter still has a couple of TODOS in,
but its content is mostly there, so you should be able to follow along.</p>
</div>
<div class="paragraph">
<p>But as always I really, really need fedback.
So please hit me up at <a href="mailto:obeythetestinggoat@gmail.com">obeythetestinggoat@gmail.com</a>, or via
<a href="https://github.com/hjwp/Book-TDD-Web-Dev-Python/issues">GitHub Issues</a>
and Pull Requests.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_what_we_need_to_do">What We Need to Do</h3>
<div class="paragraph">
<p>What&#8217;s wrong with our hacky container image?
A few things: first, we need to host our app on the "normal" port 80
so that people can access it using a regular URL.</p>
</div>
<div class="paragraph">
<p>Perhaps more importantly, we shouldn&#8217;t use the Django dev server for production;
it&#8217;s not designed for real-life workloads.
Instead, we&#8217;ll use the popular Gunicorn Python/WSGI server.</p>
</div>
<div class="paragraph">
<p>
In addition, several options in <em>settings.py</em> are currently unacceptable.
<code>DEBUG=True</code>, is strongly recommended against for production,
we&#8217;ll want to set a unique <code>SECRET_KEY</code>,
and as we&#8217;ll see, other things will come up.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s go through and see if we can fix things one by one.</p>
</div>
</div>
<div class="sect2">
<h3 id="_switching_to_gunicorn">Switching to Gunicorn</h3>
<div class="paragraph">
<p>

Do you know why the Django mascot is a pony?
The story is that Django comes with so many things you want:
an ORM, all sorts of middleware, the admin site&#8230;&#8203;
"What else do you want, a pony?" Well, Gunicorn stands for "Green Unicorn",
which I guess is what you&#8217;d want next if you already had a pony&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre>pip install gunicorn
pip freeze | grep -i gunicorn== &gt;&gt; requirements.txt</pre>
</div>
</div>
<div class="paragraph">
<p>Gunicorn will need to know a path to a WSGI server,
which is usually a function called <code>application</code>.
Django provides one in <em>superlists/wsgi.py</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>CMD ["gunicorn", "--bind", ":8888", "superlists.wsgi:application"]</pre>
</div>
</div>
<div class="paragraph">
<p>As in the previous chapter, we can use the <code>docker build &amp;&amp; docker run</code>
pattern to try out our changes by rebuilding and rerunning our container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ *docker build -t superlists . &amp;&amp; docker run \
  -p 8888:8888 \
  -v ./src/db.sqlite3:/src/db.sqlite3 \
  -it superlists*</pre>
</div>
</div>
<div class="sect3">
<h4 id="_the_fts_catch_a_problem_with_static_files">The FTs catch a problem with static files</h4>
<div class="paragraph">
<p>As we run the functional tests, you&#8217;ll see them warning us of a problem, once again.
The test for adding list items passes happily,
but the test for layout + styling fails. Good job, tests!</p>
</div>
<div class="listingblock small-code">
<div class="content">
<pre>$ <strong>TEST_SERVER=localhost:8888 python manage.py test functional_tests</strong>
[...]
AssertionError: 102.5 != 512 within 10 delta (409.5 difference)
FAILED (failures=1)</pre>
</div>
</div>
<div class="paragraph">
<p>And indeed, if you take a look at the site, you&#8217;ll find the CSS is all broken,
as in <a href="#site-with-broken-css">Broken CSS</a>.</p>
</div>
<div class="paragraph">
<p>The reason that the CSS is broken is that although the Django dev server will
serve static files magically for you, Gunicorn doesn&#8217;t.</p>
</div>
<div id="site-with-broken-css" class="imageblock">
<div class="content">
<img src="images/twp2_1001.png" alt="The site is up, but CSS is broken">
</div>
<div class="title">Figure 1. Broken CSS</div>
</div>
<div class="paragraph">
<p>One step forward, one step backward,
but once again we&#8217;ve identified the problem nice and early.
Moving on!</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_serving_static_files_with_whitenoise">Serving Static Files with Whitenoise</h3>
<div class="paragraph">
<p>Serving static files is very different from serving
dynamically rendered content from Python and Django.
There are many ways to serve them in production:
you can use a web server like Nginx, or a CDN like Amazon S3,
but in our case, the most straightforward thing to do
is to use <a href="https://whitenoise.readthedocs.io/">Whitenoise</a>,
a Python library for expressly designed serving static<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>
files from Python.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s install it first:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>pip install whitenoise
pip freeze | grep -i whitenoise== &gt;&gt; requirements.txt</pre>
</div>
</div>
<div class="paragraph">
<p>Then we tell Django to enable it:</p>
</div>
<div class="exampleblock sourcecode">
<div class="title">src/superlists/settings.py (ch10l003)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">MIDDLEWARE = [
    <span class="string"><span class="delimiter">"</span><span class="content">django.middleware.security.SecurityMiddleware</span><span class="delimiter">"</span></span>,
    <span class="string"><span class="delimiter">"</span><span class="content">whitenoise.middleware.WhiteNoiseMiddleware</span><span class="delimiter">"</span></span>,
    <span class="string"><span class="delimiter">"</span><span class="content">django.contrib.sessions.middleware.SessionMiddleware</span><span class="delimiter">"</span></span>,
    [...]</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And if you take another manual look at your site, things should look much healthier.
Let&#8217;s rerun our FTs to confirm:</p>
</div>
<div class="listingblock small-code">
<div class="content">
<pre>$ <strong>TEST_SERVER=localhost:8888 python manage.py test functional_tests --failfast</strong>
[...]

...
 ---------------------------------------------------------------------
Ran 3 tests in 10.718s

OK</pre>
</div>
</div>
<div class="paragraph">
<p>Phew.  Let&#8217;s commit that</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*git commit -am"Switch to Gunicorn and Whitenoise"*</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_environment_variables_to_adjust_settings_for_production">Using Environment Variables to Adjust Settings for Production</h3>
<div class="paragraph">
<p>
We know there are several things in
<em>settings.py</em> that we want to change for production:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DEBUG</code> mode is all very well for hacking about on your own server,
but it <a href="https://docs.djangoproject.com/en/1.11/ref/settings/#debug">isn&#8217;t secure</a>.
For example, exposing raw tracebacks to the world is a bad idea.</p>
</li>
<li>
<p><code>SECRET_KEY</code> is used by Django for some of its crypto&#8212;&#8203;things
like cookies and CSRF protection.
It&#8217;s good practice to make sure the secret key in production is different
from the one in your source code repo,
because that code might be visible to strangers.
We&#8217;ll want to generate a new, random one
but then keep it the same for the foreseeable future
(find out more in the <a href="https://docs.djangoproject.com/en/4.2/topics/signing/">Django docs</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Development, staging and production sites always have some differences
in their configuration.
Environment variables are a good place to store those different settings.
See <a href="http://www.clearlytech.com/2014/01/04/12-factor-apps-plain-english/">
"the 12-factor app"</a>.<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
<div class="sect3">
<h4 id="_setting_debugtrue_and_secret_key">Setting DEBUG=True and SECRET_KEY</h4>
<div class="paragraph">
<p>There&#8217;s lots of ways you might do this.
Here&#8217;s what I propose; it may seem a little fiddly,
but I&#8217;ll provide a little justification for each choice.
Let them be an inspiration (but not a template) for your own choices!</p>
</div>
<div class="exampleblock sourcecode">
<div class="title">superlists/settings.py (ch10l005)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">os</span>
[...]

<span class="keyword">if</span> <span class="string"><span class="delimiter">"</span><span class="content">DJANGO_DEBUG_FALSE</span><span class="delimiter">"</span></span> <span class="keyword">in</span> os.environ:  <i class="conum" data-value="1"></i><b>(1)</b>
    DEBUG = <span class="predefined-constant">False</span>
    SECRET_KEY = os.environ[<span class="string"><span class="delimiter">"</span><span class="content">DJANGO_SECRET_KEY</span><span class="delimiter">"</span></span>]  <i class="conum" data-value="2"></i><b>(2)</b>
<span class="keyword">else</span>:
    DEBUG = <span class="predefined-constant">True</span>  <i class="conum" data-value="3"></i><b>(3)</b>
    SECRET_KEY = <span class="string"><span class="delimiter">"</span><span class="content">insecure-key-for-dev</span><span class="delimiter">"</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We say we&#8217;ll use an environment variable called <code>DJANGO_DEBUG_FALSE</code>
to switch debug mode off, and in effect require production settings
(it doesn&#8217;t matter what we set it to, just that it&#8217;s there).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>And now we say that, if debug mode is off,
we <em>require</em> the <code>SECRET_KEY</code> to be set by a second environment variable.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Otherwise we fall-back to the insecure, debug mode settings that
are useful for Dev.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The end result is that you don&#8217;t need to set any env vars for dev,
but production needs both to be set explicitly,
and it will error if any are missing.
I think this gives us a little bit of protection
against accidentally forgetting to set one.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Better to fail hard than allow a typo in an environment variable name to
    leave you running with insecure settings.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_setting_environment_variables_inside_the_dockerfile">Setting environment variables inside the Dockerfile</h4>
<div class="paragraph">
<p>Now let&#8217;s set that environment variable in our Dockerfile using then <code>ENV</code> directive:</p>
</div>
<div class="exampleblock sourcecode">
<div class="title">Dockerfile (ch10l006)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="dockerfile">WORKDIR /src

ENV DJANGO_DEBUG_FALSE=1
CMD ["gunicorn", "--bind", ":8888", "superlists.wsgi:application"]</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>And try it out&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ *docker build -t superlists . &amp;&amp; docker run \
  -p 8888:8888 \
  -v ./src/db.sqlite3:/src/db.sqlite3 \
  -it superlists*

[...]
    SECRET_KEY = os.environ["DJANGO_SECRET_KEY"]
                 ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
# TODO: show more of traceback</pre>
</div>
</div>
<div class="paragraph">
<p>Ooops, and I forgot to set said secret key env var,
mere seconds after having dreamt it up!</p>
</div>
</div>
<div class="sect3">
<h4 id="_setting_environment_variables_at_the_docker_command_line">Setting environment variables at the docker command-line</h4>
<div class="paragraph">
<p>We&#8217;ve said we can&#8217;t keep the secret key in our source code,
so the Dockerfile isn&#8217;t an option; where else can we put it?</p>
</div>
<div class="paragraph">
<p>For now, we can set it at the command line using the <code>-e</code> flag for <code>docker run</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker build -t superlists . &amp;&amp; docker run \
  -p 8888:8888 \
  -v ./src/db.sqlite3:/src/db.sqlite3 \
  -e DJANGO_SECRET_KEY=sekrit \
  -it superlists</strong></pre>
</div>
</div>
<div class="paragraph">
<p>With that running, we can use our FT again to see if we&#8217;re back to a working state.</p>
</div>
<div class="listingblock small-code">
<div class="content">
<pre>$ <strong>TEST_SERVER=localhost:8888 ./manage.py test functional_tests --failfast</strong>
[...]
AssertionError: 'To-Do' not found in 'Bad Request (400)'</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_allowed_hosts_is_required_when_debug_mode_is_turned_off">ALLOWED_HOSTS is Required When Debug Mode is Turned Off</h4>
<div class="paragraph">
<p>Not quite!  Let&#8217;s take a look manually: <a href="#django-400-error">An ugly 400 error</a>.</p>
</div>
<div id="django-400-error" class="imageblock">
<div class="content">
<img src="images/twp2_1002.png" alt="An unfriendly page showing 400 Bad Request">
</div>
<div class="title">Figure 2. An ugly 400 error</div>
</div>
<div class="paragraph">
<p>We&#8217;ve set our two environment variables but doing so seems to have broken things.
But once again, by running our FTs frequently,
we&#8217;re able to identify the problem early,
before we&#8217;ve changed too many things at the same time.
We&#8217;ve only changed two settings&#8212;which one might be at fault?</p>
</div>
<div class="paragraph">
<p>Let&#8217;s use the "Googling the error message" technique again,
with the search terms "django debug false" and "400 bad request".</p>
</div>
<div class="paragraph">
<p>Well, the very first link in my <a href="https://duckduckgo.com/?q=django+400+bad+request">search results</a>
was Stackoverflow suggesting that a 400 error is usually to do with <code>ALLOWED_HOSTS</code>,
and the second was the official Django docs,
which takes a bit more scrolling, but confirms it
(see <a href="#search-results-400-bad-request">Search results for "django debug false 400 bad request"</a>).</p>
</div>
<div id="search-results-400-bad-request" class="imageblock">
<div class="content">
<img src="images/search-results-400-bad-request.png" alt="Duckduckgo search results with stackoverflow and django docs">
</div>
<div class="title">Figure 3. Search results for "django debug false 400 bad request"</div>
</div>
<div class="paragraph">
<p><code>ALLOWED_HOSTS</code> is a security setting
designed to reject requests that are likely to be forged, broken or malicious
because they don&#8217;t appear to be asking for your site
(HTTP request contain the address they were intended for in a header called "Host").</p>
</div>
<div class="paragraph">
<p>By default, when DEBUG=True, <code>ALLOWED_HOSTS</code> effectively allows <em>localhost</em>,
our own machine, so that&#8217;s why it was working OK until now.</p>
</div>
<div class="paragraph">
<p>There&#8217;s more information in the
<a href="https://docs.djangoproject.com/en/4.2/ref/settings/#allowed-hosts">Django docs</a>.</p>
</div>
<div class="paragraph">
<p>The upshot is that we need to adjust <code>ALLOWED_HOSTS</code> in <em>settings.py</em>.
Let&#8217;s use another environment variable for that:</p>
</div>
<div class="exampleblock sourcecode">
<div class="title">superlists/settings.py (ch10l007)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">if</span> <span class="string"><span class="delimiter">"</span><span class="content">DJANGO_DEBUG_FALSE</span><span class="delimiter">"</span></span> <span class="keyword">in</span> os.environ:
    DEBUG = <span class="predefined-constant">False</span>
    SECRET_KEY = os.environ[<span class="string"><span class="delimiter">"</span><span class="content">DJANGO_SECRET_KEY</span><span class="delimiter">"</span></span>]
    ALLOWED_HOSTS = [os.environ[<span class="string"><span class="delimiter">"</span><span class="content">DJANGO_ALLOWED_HOST</span><span class="delimiter">"</span></span>]]
<span class="keyword">else</span>:
    DEBUG = <span class="predefined-constant">True</span>
    SECRET_KEY = <span class="string"><span class="delimiter">"</span><span class="content">insecure-key-for-dev</span><span class="delimiter">"</span></span>
    ALLOWED_HOSTS = []</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This is a setting that we want to change,
depending on whether our docker image is running locally,
or on a server, so we&#8217;ll use the <code>-e</code> flag again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ <strong>docker build -t superlists . &amp;&amp; \
    docker run -p 8888:8888 -v ./src/db.sqlite3:/src/db.sqlite3 \
        -e DJANGO_SECRET_KEY=sekrit \
        -e DJANGO_ALLOWED_HOST=localhost \
        -it superlists</strong></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_collectstatic_is_required_when_debug_is_turned_off">Collectstatic is Required when Debug is Turned Off</h4>
<div class="paragraph">
<p>An FT run (or just looking at the site) reveals that we&#8217;ve had a regression
in our static files.</p>
</div>
<div class="listingblock small-code">
<div class="content">
<pre>$ <strong>TEST_SERVER=localhost:8888 python manage.py test functional_tests</strong>
[...]
AssertionError: 102.5 != 512 within 10 delta (409.5 difference)
FAILED (failures=1)</pre>
</div>
</div>
<div class="paragraph">
<p>We saw this before when switching from the Django dev server to Gunicorn,
so we introduced Whitenoise.
Similarly, when we switch DEBUG off,
Whitenoise stops automagically finding static files in our code,
and instead we need to run <code>collectstatic</code>:</p>
</div>
<div class="exampleblock sourcecode">
<div class="title">Dockerfile (ch10l008)</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="dockerfile">WORKDIR /src

RUN python manage.py collectstatic

ENV DJANGO_DEBUG_FALSE=1
CMD ["gunicorn", "--bind", ":8888", "superlists.wsgi:application"]</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Well, it was fiddly, but that should get us to passing tests!</p>
</div>
<div class="listingblock small-code">
<div class="content">
<pre>$ <strong>TEST_SERVER=localhost:8888 python manage.py test functional_tests</strong>
[...]
OK</pre>
</div>
</div>
<div class="paragraph">
<p>We have a container that we&#8217;re ready to ship to production!</p>
</div>
<div class="paragraph">
<p>Find out how in the next exciting installment.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_todo_log_files">TODO: log files</h3>
<div class="paragraph">
<p>provoke a 500 error somehow and make sure we see tracebacks for it</p>
</div>
<div class="sidebarblock pagebreak-before less_space">
<div class="content">
<div class="title">Production-Readiness Config</div>
<div class="paragraph">
<p>
A few things to think about when trying to prepare a production-ready configuration:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Don&#8217;t use the Django dev server in production</dt>
<dd>
<p>Something like Gunicorn or uWSGI is a better tool for running Django;
it will let you run multiple workers, for example.
</p>
</dd>
<dt class="hdlist1">Decide how to serve your static files</dt>
<dd>
<p>Static files aren&#8217;t the same kind of things as the dynamic content
that comes from Django and your webapp, so they need to be treated differently.
WhiteNoise is just one example of how you might do that.</p>
</dd>
<dt class="hdlist1">Check your settings.py for dev-only settings</dt>
<dd>
<p><code>DEBUG=True</code>, <code>ALLOWED_HOSTS</code> and <code>SECRET_KEY</code> are the ones we came across,
but you will probably have others
(we&#8217;ll see more when we start to send emails from the server).</p>
</dd>
<dt class="hdlist1">Change things one at a time and rerun your tests frequently</dt>
<dd>
<p>Whenever we make a change to our server configuration,
we can rerun the test suite,
and either be confident that everything works as well as it did before,
or find out immediately if we did something wrong.</p>
</dd>
<dt class="hdlist1">Security</dt>
<dd>
<p>A serious discussion of server security is beyond the scope of this book,
and I&#8217;d warn against running your own servers
without learning a good bit more about it.
(One reason people choose to use a PaaS to host their code
is that it means a slightly fewer security issues to worry about.)
If you&#8217;d like a place to start, here&#8217;s as good a place as any:
<a href="https://plusbryan.com/my-first-5-minutes-on-a-server-or-essential-security-for-linux-servers">My first 5 minutes on a server</a>.
I can definitely recommend the eye-opening experience of installing
fail2ban and watching its logfiles to see just how quickly it picks up on
random drive-by attempts to brute force your SSH login.  The internet is a
wild place!

</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>TODO: that last one probably belongs in the next chapter.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Believe it or not, this pun didn&#8217;t actually hit me until I was rewriting this chapter. For 10 years it was right under my nose. I think that makes it funnier actually.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. Another common way of handling this is to have different versions of <em>settings.py</em> for dev and prod. That can work fine too, but it can get confusing to manage. Environment variables also have the advantage of working for non-Django stuff too&#8230;&#8203;
</div>
</div>
<div id="footer">
<div id="footer-text">
License: Creative Commons <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/legalcode">CC-BY-NC-ND</a>. Last updated: 2024-01-22 06:53:07 UTC
</div>
</div>
<div class="comments" style="padding: 20px">
  <h3>Comments</h3>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
        this.page.identifier = 'chapter_10_production_readiness';
    };
    
    (function() {
        var d = document, s = d.createElement('script');
        s.src = '//obeythetestinggoat.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>

<html><head><script>   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){   (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)   })(window,document,'script','//www.google-analytics.com/analytics.js','ga');    ga('create', 'UA-40928035-1', 'obeythetestinggoat.com');   ga('send', 'pageview');  </script>
</head></html></body>
</html>